30.2 The DFT and FFT                                                          911


R ECURSIVE -FFT.a/
 1 n D a:length                     // n is a power of 2
 2 if n == 1
 3       return a
 4 !n D e 2 i=n
 5 ! D1
 6 aŒ0 D .a0 ; a2 ; : : : ; an2 /
 7 aŒ1 D .a1 ; a3 ; : : : ; an1 /
 8 y Œ0 D R ECURSIVE -FFT.aŒ0 /
 9 y Œ1 D R ECURSIVE -FFT.aŒ1 /
10 for k D 0 to n=2  1
11       yk D ykŒ0 C ! ykŒ1
12       ykC.n=2/ D ykŒ0  ! ykŒ1
13       ! D ! !n
14 return y                         // y is assumed to be a column vector

The R ECURSIVE -FFT procedure works as follows. Lines 2–3 represent the basis
of the recursion; the DFT of one element is the element itself, since in this case
y0 D a0 !10
   D a0  1
   D a0 :
Lines 6–7 deﬁne the coefﬁcient vectors for the polynomials AŒ0 and AŒ1 . Lines
4, 5, and 13 guarantee that ! is updated properly so that whenever lines 11–12
are executed, we have ! D !nk . (Keeping a running value of ! from iteration
to iteration saves time over computing !nk from scratch each time through the for
loop.) Lines 8–9 perform the recursive DFTn=2 computations, setting, for k D
0; 1; : : : ; n=2  1,

ykŒ0 D AŒ0 .!n=2
               k
                   /;
ykŒ1 D AŒ1 .!n=2
               k
                   /;
           k
or, since !n=2 D !n2k by the cancellation lemma,

ykŒ0 D AŒ0 .!n2k / ;
ykŒ1 D AŒ1 .!n2k / :
