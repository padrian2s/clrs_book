172   Chapter 7 Quicksort


             i p,j                          r
      (a)       2 8     7   1   3   5   6   4

                p,i j                       r
      (b)        2 8    7   1   3   5   6   4

                p,i     j                   r
      (c)        2 8    7   1   3   5   6   4

                p,i         j               r
      (d)        2 8    7   1   3   5   6   4

                p   i           j           r
      (e)       2   1   7   8   3   5   6   4

                p       i           j       r
      (f)       2   1   3   8   7   5   6   4

                p       i               j   r
      (g)       2   1   3   8   7   5   6   4

                p       i                   r
      (h)       2   1   3   8   7   5   6   4

                p       i                   r
      (i)       2   1   3   4   7   5   6   8



      Figure 7.1 The operation of PARTITION on a sample array. Array entry AŒr becomes the pivot
      element x. Lightly shaded array elements are all in the ﬁrst partition with values no greater than x.
      Heavily shaded elements are in the second partition with values greater than x. The unshaded el-
      ements have not yet been put in one of the ﬁrst two partitions, and the ﬁnal white element is the
      pivot x. (a) The initial array and variable settings. None of the elements have been placed in either
      of the ﬁrst two partitions. (b) The value 2 is “swapped with itself” and put in the partition of smaller
      values. (c)–(d) The values 8 and 7 are added to the partition of larger values. (e) The values 1 and 8
      are swapped, and the smaller partition grows. (f) The values 3 and 7 are swapped, and the smaller
      partition grows. (g)–(h) The larger partition grows to include 5 and 6, and the loop terminates. (i) In
      lines 7–8, the pivot element is swapped so that it lies between the two partitions.


      The indices between j and r  1 are not covered by any of the three cases, and the
      values in these entries have no particular relationship to the pivot x.
        We need to show that this loop invariant is true prior to the ﬁrst iteration, that
      each iteration of the loop maintains the invariant, and that the invariant provides a
      useful property to show correctness when the loop terminates.
