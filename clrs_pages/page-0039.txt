18   Chapter 2 Getting Started


             1   2   3   4   5   6            1   2   3   4   5   6              1   2   3   4   5   6
     (a)     5   2   4   6   1   3     (b)    2   5   4   6   1   3       (c)    2   4   5   6   1   3



             1   2   3   4   5   6            1   2   3   4   5   6              1   2   3   4   5   6
     (d)     2   4   5   6   1   3     (e)    1   2   4   5   6   3        (f)   1   2   3   4   5   6




     Figure 2.2 The operation of I NSERTION -S ORT on the array A D h5; 2; 4; 6; 1; 3i. Array indices
     appear above the rectangles, and values stored in the array positions appear within the rectangles.
     (a)–(e) The iterations of the for loop of lines 1–8. In each iteration, the black rectangle holds the
     key taken from AŒj , which is compared with the values in shaded rectangles to its left in the test of
     line 5. Shaded arrows show array values moved one position to the right in line 6, and black arrows
     indicate where the key moves to in line 8. (f) The ﬁnal sorted array.


     I NSERTION -S ORT .A/
     1 for j D 2 to A:length
     2       key D AŒj 
     3       // Insert AŒj  into the sorted sequence AŒ1 : : j  1.
     4       i D j 1
     5       while i > 0 and AŒi > key
     6            AŒi C 1 D AŒi
     7            i D i 1
     8       AŒi C 1 D key

     Loop invariants and the correctness of insertion sort
     Figure 2.2 shows how this algorithm works for A D h5; 2; 4; 6; 1; 3i. The in-
     dex j indicates the “current card” being inserted into the hand. At the beginning
     of each iteration of the for loop, which is indexed by j , the subarray consisting
     of elements AŒ1 : : j  1 constitutes the currently sorted hand, and the remaining
     subarray AŒj C 1 : : n corresponds to the pile of cards still on the table. In fact,
     elements AŒ1 : : j  1 are the elements originally in positions 1 through j  1, but
     now in sorted order. We state these properties of AŒ1 : : j  1 formally as a loop
     invariant:

           At the start of each iteration of the for loop of lines 1–8, the subarray
           AŒ1 : : j  1 consists of the elements originally in AŒ1 : : j  1, but in sorted
           order.

      We use loop invariants to help us understand why an algorithm is correct. We
     must show three things about a loop invariant:
