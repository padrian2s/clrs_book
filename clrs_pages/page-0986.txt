           31.8 Primality testing                                                           965


           31.7-2
           Prove that if Alice’s public exponent e is 3 and an adversary obtains Alice’s secret
           exponent d , where 0 < d < .n/, then the adversary can factor Alice’s modulus n
           in time polynomial in the number of bits in n. (Although you are not asked to prove
           it, you may be interested to know that this result remains true even if the condition
           e D 3 is removed. See Miller [255].)

           31.7-3 ?
           Prove that RSA is multiplicative in the sense that
           PA .M1 /PA .M2 /  PA .M1 M2 / .mod n/ :
           Use this fact to prove that if an adversary had a procedure that could efﬁciently
           decrypt 1 percent of messages from Zn encrypted with PA , then he could employ
           a probabilistic algorithm to decrypt every message encrypted with PA with high
           probability.



? 31.8 Primality testing

           In this section, we consider the problem of ﬁnding large primes. We begin with a
           discussion of the density of primes, proceed to examine a plausible, but incomplete,
           approach to primality testing, and then present an effective randomized primality
           test due to Miller and Rabin.

           The density of prime numbers
           For many applications, such as cryptography, we need to ﬁnd large “random”
           primes. Fortunately, large primes are not too rare, so that it is feasible to test
           random integers of the appropriate size until we ﬁnd a prime. The prime distribu-
           tion function .n/ speciﬁes the number of primes that are less than or equal to n.
           For example, .10/ D 4, since there are 4 prime numbers less than or equal to 10,
           namely, 2, 3, 5, and 7. The prime number theorem gives a useful approximation
           to .n/.

           Theorem 31.37 (Prime number theorem)
                .n/
            lim        D1:
           n!1 n= ln n



              The approximation n= ln n gives reasonably accurate estimates of .n/ even
           for small n. For example, it is off by less than 6% at n D 109 , where .n/ D
