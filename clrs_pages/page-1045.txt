1024   Chapter 33 Computational Geometry


       solely on simple properties of the input data. In particular, each segment endpoint
       is an event point. We sort the segment endpoints by increasing x-coordinate and
       proceed from left to right. (If two or more endpoints are covertical, i.e., they have
       the same x-coordinate, we break the tie by putting all the covertical left endpoints
       before the covertical right endpoints. Within a set of covertical left endpoints, we
       put those with lower y-coordinates ﬁrst, and we do the same within a set of cover-
       tical right endpoints.) When we encounter a segment’s left endpoint, we insert the
       segment into the sweep-line status, and we delete the segment from the sweep-line
       status upon encountering its right endpoint. Whenever two segments ﬁrst become
       consecutive in the total preorder, we check whether they intersect.
          The sweep-line status is a total preorder T , for which we require the following
       operations:
          I NSERT .T; s/: insert segment s into T .
          D ELETE .T; s/: delete segment s from T .
          A BOVE.T; s/: return the segment immediately above segment s in T .
          B ELOW .T; s/: return the segment immediately below segment s in T .
       It is possible for segments s1 and s2 to be mutually above each other in the total
       preorder T ; this situation can occur if s1 and s2 intersect at the sweep line whose
       total preorder is given by T . In this case, the two segments may appear in either
       order in T .
          If the input contains n segments, we can perform each of the operations I NSERT,
       D ELETE, A BOVE, and B ELOW in O.lg n/ time using red-black trees. Recall that
       the red-black-tree operations in Chapter 13 involve comparing keys. We can re-
       place the key comparisons by comparisons that use cross products to determine the
       relative ordering of two segments (see Exercise 33.2-2).

       Segment-intersection pseudocode
       The following algorithm takes as input a set S of n line segments, returning the
       boolean value TRUE if any pair of segments in S intersects, and FALSE otherwise.
       A red-black tree maintains the total preorder T .
