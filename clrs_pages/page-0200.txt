           7.3 A randomized version of quicksort                                             179


           7.2-6 ?
           Argue that for any constant 0 < ˛  1=2, the probability is approximately 1  2˛
           that on a random input array, PARTITION produces a split more balanced than 1˛
           to ˛.



7.3 A randomized version of quicksort

           In exploring the average-case behavior of quicksort, we have made an assumption
           that all permutations of the input numbers are equally likely. In an engineering
           situation, however, we cannot always expect this assumption to hold. (See Exer-
           cise 7.2-4.) As we saw in Section 5.3, we can sometimes add randomization to an
           algorithm in order to obtain good expected performance over all inputs. Many peo-
           ple regard the resulting randomized version of quicksort as the sorting algorithm
           of choice for large enough inputs.
              In Section 5.3, we randomized our algorithm by explicitly permuting the in-
           put. We could do so for quicksort also, but a different randomization technique,
           called random sampling, yields a simpler analysis. Instead of always using AŒr
           as the pivot, we will select a randomly chosen element from the subarray AŒp : : r.
           We do so by ﬁrst exchanging element AŒr with an element chosen at random
           from AŒp : : r. By randomly sampling the range p; : : : ; r, we ensure that the pivot
           element x D AŒr is equally likely to be any of the r  p C 1 elements in the
           subarray. Because we randomly choose the pivot element, we expect the split of
           the input array to be reasonably well balanced on average.
              The changes to PARTITION and Q UICKSORT are small. In the new partition
           procedure, we simply implement the swap before actually partitioning:

           R ANDOMIZED -PARTITION .A; p; r/
           1 i D R ANDOM .p; r/
           2 exchange AŒr with AŒi
           3 return PARTITION .A; p; r/
           The new quicksort calls R ANDOMIZED -PARTITION in place of PARTITION:

           R ANDOMIZED -Q UICKSORT .A; p; r/
           1 if p < r
           2      q D R ANDOMIZED -PARTITION .A; p; r/
           3      R ANDOMIZED -Q UICKSORT .A; p; q  1/
           4      R ANDOMIZED -Q UICKSORT .A; q C 1; r/
           We analyze this algorithm in the next section.
