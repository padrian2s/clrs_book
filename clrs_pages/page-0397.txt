376                    Chapter 15 Dynamic Programming


                                           m                                                                           s
                                      6           1                                                                6       1
                               5         15,125
                                             2                                                                 5       3       2
                                                                                                       j                               i
               j                11,875 10,500                         i                                            3       3
                         4                                     3                                           4                       3
                   3         9,375        7,125        5,375         4                              3          3       3       3           4
           2           7,875     4,375         2,500       3,500            5                  2           1       3       3       5           5
      1     15,750           2,625        750          1,000        5,000        6                 1           2       3       4           5
          0             0            0            0            0            0

          A1            A2           A3           A4           A5           A6



                       Figure 15.5 The m and s tables computed by M ATRIX -C HAIN -O RDER for n D 6 and the follow-
                       ing matrix dimensions:
                         matrix             A1             A2              A3            A4          A5          A6
                       dimension          30 35          35 15            15 5       5    10       10 20       20 25
                       The tables are rotated so that the main diagonal runs horizontally. The m table uses only the main
                       diagonal and upper triangle, and the s table uses only the upper triangle. The minimum number of
                       scalar multiplications to multiply the 6 matrices is mŒ1; 6 D 15,125. Of the darker entries, the pairs
                       that have the same shading are taken together in line 10 when computing
                                        8
                                        ˆ
                                        <mŒ2; 2 C mŒ3; 5 C p1 p2 p5 D 0 C 2500 C 35  15  20         D 13,000 ;
                       mŒ2; 5 D min mŒ2; 3 C mŒ4; 5 C p1 p3 p5 D 2625 C 1000 C 35  5  20 D 7125 ;
                                        :̂
                                          mŒ2; 4 C mŒ5; 5 C p1 p4 p5 D 4375 C 0 C 35  10  20        D 11,375
                                D 7125 :



                          The algorithm ﬁrst computes mŒi; i D 0 for i D 1; 2; : : : ; n (the minimum
                       costs for chains of length 1) in lines 3–4. It then uses recurrence (15.7) to compute
                       mŒi; i C 1 for i D 1; 2; : : : ; n  1 (the minimum costs for chains of length l D 2)
                       during the ﬁrst execution of the for loop in lines 5–13. The second time through the
                       loop, it computes mŒi; iC2 for i D 1; 2; : : : ; n2 (the minimum costs for chains of
                       length l D 3), and so forth. At each step, the mŒi; j  cost computed in lines 10–13
                       depends only on table entries mŒi; k and mŒk C 1; j  already computed.
                          Figure 15.5 illustrates this procedure on a chain of n D 6 matrices. Since
                       we have deﬁned mŒi; j  only for i  j , only the portion of the table m strictly
                       above the main diagonal is used. The ﬁgure shows the table rotated to make the
                       main diagonal run horizontally. The matrix chain is listed along the bottom. Us-
                       ing this layout, we can ﬁnd the minimum cost mŒi; j  for multiplying a subchain
                       Ai Ai C1    Aj of matrices at the intersection of lines running northeast from Ai and
