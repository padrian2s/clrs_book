          26.1 Flow networks                                                                709


          ﬁnding a maximum matching in an undirected bipartite graph, appears in Sec-
          tion 26.3. Section 26.4 presents the push-relabel method, which underlies many of
          the fastest algorithms for network-ﬂow problems. Section 26.5 covers the “relabel-
          to-front” algorithm, a particular implementation of the push-relabel method that
          runs in time O.V 3 /. Although this algorithm is not the fastest algorithm known,
          it illustrates some of the techniques used in the asymptotically fastest algorithms,
          and it is reasonably efﬁcient in practice.


26.1 Flow networks

          In this section, we give a graph-theoretic deﬁnition of ﬂow networks, discuss their
          properties, and deﬁne the maximum-ﬂow problem precisely. We also introduce
          some helpful notation.

          Flow networks and ﬂows
          A ﬂow network G D .V; E/ is a directed graph in which each edge .u; / 2 E
          has a nonnegative capacity c.u; /  0. We further require that if E contains an
          edge .u; /, then there is no edge .; u/ in the reverse direction. (We shall see
          shortly how to work around this restriction.) If .u; / 62 E, then for convenience
          we deﬁne c.u; / D 0, and we disallow self-loops. We distinguish two vertices
          in a ﬂow network: a source s and a sink t. For convenience, we assume that each
          vertex lies on some path from the source to the sink. That is, for each vertex  2 V ,
          the ﬂow network contains a path s ;  ; t. The graph is therefore connected
          and, since each vertex other than s has at least one entering edge, jEj  jV j  1.
          Figure 26.1 shows an example of a ﬂow network.
             We are now ready to deﬁne ﬂows more formally. Let G D .V; E/ be a ﬂow
          network with a capacity function c. Let s be the source of the network, and let t be
          the sink. A ﬂow in G is a real-valued function f W V V ! R that satisﬁes the
          following two properties:
          Capacity constraint: For all u;  2 V , we require 0  f .u; /  c.u; /.
          Flow conservation: For all u 2 V  fs; tg, we require
             X                  X
                   f .; u/ D         f .u; / :
             2V                2V


          When .u; / 62 E, there can be no ﬂow from u to , and f .u; / D 0.
