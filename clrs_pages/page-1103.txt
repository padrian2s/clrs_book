1082   Chapter 34 NP-Completeness


       3-CNF satisﬁability
       We can prove many problems NP-complete by reducing from formula satisﬁability.
       The reduction algorithm must handle any input formula, though, and this require-
       ment can lead to a huge number of cases that we must consider. We often prefer
       to reduce from a restricted language of boolean formulas, so that we need to con-
       sider fewer cases. Of course, we must not restrict the language so much that it
       becomes polynomial-time solvable. One convenient language is 3-CNF satisﬁabil-
       ity, or 3-CNF-SAT.
          We deﬁne 3-CNF satisﬁability using the following terms. A literal in a boolean
       formula is an occurrence of a variable or its negation. A boolean formula is in
       conjunctive normal form, or CNF, if it is expressed as an AND of clauses, each
       of which is the OR of one or more literals. A boolean formula is in 3-conjunctive
       normal form, or 3-CNF, if each clause has exactly three distinct literals.
          For example, the boolean formula
       .x1 _ :x1 _ :x2 / ^ .x3 _ x2 _ x4 / ^ .:x1 _ :x3 _ :x4 /
       is in 3-CNF. The ﬁrst of its three clauses is .x1 _ :x1 _ :x2 /, which contains the
       three literals x1 , :x1 , and :x2 .
          In 3-CNF-SAT, we are asked whether a given boolean formula  in 3-CNF is
       satisﬁable. The following theorem shows that a polynomial-time algorithm that
       can determine the satisﬁability of boolean formulas is unlikely to exist, even when
       they are expressed in this simple normal form.

       Theorem 34.10
       Satisﬁability of boolean formulas in 3-conjunctive normal form is NP-complete.

       Proof The argument we used in the proof of Theorem 34.9 to show that SAT 2
       NP applies equally well here to show that 3-CNF-SAT 2 NP. By Lemma 34.8,
       therefore, we need only show that SAT P 3-CNF-SAT.
          We break the reduction algorithm into three basic steps. Each step progressively
       transforms the input formula  closer to the desired 3-conjunctive normal form.
          The ﬁrst step is similar to the one used to prove CIRCUIT-SAT P SAT in
       Theorem 34.9. First, we construct a binary “parse” tree for the input formula ,
       with literals as leaves and connectives as internal nodes. Figure 34.11 shows such
       a parse tree for the formula
        D ..x1 ! x2 / _ :..:x1 $ x3 / _ x4 // ^ :x2 :                               (34.3)
       Should the input formula contain a clause such as the OR of several literals, we use
       associativity to parenthesize the expression fully so that every internal node in the
       resulting tree has 1 or 2 children. We can now think of the binary parse tree as a
       circuit for computing the function.
