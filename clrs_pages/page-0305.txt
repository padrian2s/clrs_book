284   Chapter 11 Hash Tables


      11-4 Hashing and authentication
      Let H be a class of hash functions in which each hash function h 2 H maps the
      universe U of keys to f0; 1; : : : ; m  1g. We say that H is k-universal if, for every
      ﬁxed sequence of k distinct keys hx .1/ ; x .2/ ; : : : ; x .k/ i and for any h chosen at
      random from H , the sequence hh.x .1/ /; h.x .2/ /; : : : ; h.x .k/ /i is equally likely to be
      any of the mk sequences of length k with elements drawn from f0; 1; : : : ; m  1g.

      a. Show that if the family H of hash functions is 2-universal, then it is universal.

      b. Suppose that the universe U is the set of n-tuples of values drawn from
         Zp D f0; 1; : : : ; p  1g, where p is prime. Consider an element x D
         hx0 ; x1 ; : : : ; xn1 i 2 U . For any n-tuple a D ha0 ; a1 ; : : : ; an1 i 2 U , de-
         ﬁne the hash function ha by
                                   !
                         Xn1
         ha .x/ D             aj xj mod p :
                      j D0


         Let H D fha g. Show that H is universal, but not 2-universal. (Hint: Find a key
         for which all hash functions in H produce the same value.)

      c. Suppose that we modify H slightly from part (b): for any a 2 U and for any
         b 2 Zp , deﬁne
                                          !
                       X
                       n1
         h0ab .x/ D           aj xj C b       mod p
                       j D0


         and H 0 D fh0ab g. Argue that H 0 is 2-universal. (Hint: Consider ﬁxed n-tuples
         x 2 U and y 2 U , with xi ¤ yi for some i. What happens to h0ab .x/
         and h0ab .y/ as ai and b range over Zp ?)

      d. Suppose that Alice and Bob secretly agree on a hash function h from a
         2-universal family H of hash functions. Each h 2 H maps from a universe of
         keys U to Zp , where p is prime. Later, Alice sends a message m to Bob over the
         Internet, where m 2 U . She authenticates this message to Bob by also sending
         an authentication tag t D h.m/, and Bob checks that the pair .m; t/ he receives
         indeed satisﬁes t D h.m/. Suppose that an adversary intercepts .m; t/ en route
         and tries to fool Bob by replacing the pair .m; t/ with a different pair .m0 ; t 0 /.
         Argue that the probability that the adversary succeeds in fooling Bob into ac-
         cepting .m0 ; t 0 / is at most 1=p, no matter how much computing power the ad-
         versary has, and even if the adversary knows the family H of hash functions
         used.
