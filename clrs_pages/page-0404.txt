15.3 Elements of dynamic programming                                              383


   This example shows that for longest simple paths, not only does the problem
lack optimal substructure, but we cannot necessarily assemble a “legal” solution
to the problem from solutions to subproblems. If we combine the longest simple
paths q ! s ! t ! r and r ! q ! s ! t, we get the path q ! s ! t ! r !
q ! s ! t, which is not simple. Indeed, the problem of ﬁnding an unweighted
longest simple path does not appear to have any sort of optimal substructure. No
efﬁcient dynamic-programming algorithm for this problem has ever been found. In
fact, this problem is NP-complete, which—as we shall see in Chapter 34—means
that we are unlikely to ﬁnd a way to solve it in polynomial time.
   Why is the substructure of a longest simple path so different from that of a short-
est path? Although a solution to a problem for both longest and shortest paths uses
two subproblems, the subproblems in ﬁnding the longest simple path are not inde-
pendent, whereas for shortest paths they are. What do we mean by subproblems
being independent? We mean that the solution to one subproblem does not affect
the solution to another subproblem of the same problem. For the example of Fig-
ure 15.6, we have the problem of ﬁnding a longest simple path from q to t with two
subproblems: ﬁnding longest simple paths from q to r and from r to t. For the ﬁrst
of these subproblems, we choose the path q ! s ! t ! r, and so we have also
used the vertices s and t. We can no longer use these vertices in the second sub-
problem, since the combination of the two solutions to subproblems would yield a
path that is not simple. If we cannot use vertex t in the second problem, then we
cannot solve it at all, since t is required to be on the path that we ﬁnd, and it is
not the vertex at which we are “splicing” together the subproblem solutions (that
vertex being r). Because we use vertices s and t in one subproblem solution, we
cannot use them in the other subproblem solution. We must use at least one of them
to solve the other subproblem, however, and we must use both of them to solve it
optimally. Thus, we say that these subproblems are not independent. Looked at
another way, using resources in solving one subproblem (those resources being
vertices) renders them unavailable for the other subproblem.
   Why, then, are the subproblems independent for ﬁnding a shortest path? The
answer is that by nature, the subproblems do not share resources. We claim that
if a vertex w is on a shortest path p from u to , then we can splice together any
                 p                             p
shortest path u ;1 w and any shortest path w ;2  to produce a shortest path from u
to . We are assured that, other than w, no vertex can appear in both paths p1
and p2 . Why? Suppose that some vertex x ¤ w appears in both p1 and p2 , so that
                              pux                             px
we can decompose p1 as u ; x ; w and p2 as w ; x ; . By the optimal
substructure of this problem, path p has as many edges as p1 and p2 together; let’s
                                                             pux   px
say that p has e edges. Now let us construct a path p 0 D u ; x ;  from u to .
Because we have excised the paths from x to w and from w to x, each of which
contains at least one edge, path p 0 contains at most e  2 edges, which contradicts
