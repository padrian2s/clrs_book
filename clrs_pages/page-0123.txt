102   Chapter 4 Divide-and-Conquer


      capture the terms that are not covered by our assumption that n is sufﬁciently large:
                   X
                 logb n1

      g.n/ D                aj f .n=b j /
                   j D0

                   X
                 logb n1

                           c j f .n/ C O.1/
                   j D0

                          X
                          1
              f .n/             c j C O.1/
                          j D0
                                   
                        1
             D f .n/                    C O.1/
                     1c
             D O.f .n// ;
      since c is a constant. Thus, we can conclude that g.n/ D ‚.f .n// for exact powers
      of b. With case 3 proved, the proof of the lemma is complete.

        We can now prove a version of the master theorem for the case in which n is an
      exact power of b.

      Lemma 4.4
      Let a  1 and b > 1 be constants, and let f .n/ be a nonnegative function deﬁned
      on exact powers of b. Deﬁne T .n/ on exact powers of b by the recurrence
              (
                ‚.1/               if n D 1 ;
      T .n/ D
                aT .n=b/ C f .n/ if n D b i ;

      where i is a positive integer. Then T .n/ has the following asymptotic bounds for
      exact powers of b:
      1. If f .n/ D O.nlogb a / for some constant  > 0, then T .n/ D ‚.nlogb a /.
      2. If f .n/ D ‚.nlogb a /, then T .n/ D ‚.nlogb a lg n/.
      3. If f .n/ D .nlogb aC / for some constant  > 0, and if af .n=b/  cf .n/ for
         some constant c < 1 and all sufﬁciently large n, then T .n/ D ‚.f .n//.


      Proof We use the bounds in Lemma 4.3 to evaluate the summation (4.21) from
      Lemma 4.2. For case 1, we have
      T .n/ D ‚.nlogb a / C O.nlogb a /
            D ‚.nlogb a / ;
