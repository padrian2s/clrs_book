962   Chapter 31 Number-Theoretic Algorithms


      then seal the document inside a paper envelope that is opened only by the intended
      recipient.

      The RSA cryptosystem
      In the RSA public-key cryptosystem, a participant creates his or her public and
      secret keys with the following procedure:
      1. Select at random two large prime numbers p and q such that p ¤ q. The primes
         p and q might be, say, 1024 bits each.
      2. Compute n D pq.
      3. Select a small odd integer e that is relatively prime to .n/, which, by equa-
         tion (31.20), equals .p  1/.q  1/.
      4. Compute d as the multiplicative inverse of e, modulo .n/. (Corollary 31.26
         guarantees that d exists and is uniquely deﬁned. We can use the technique of
         Section 31.4 to compute d , given e and .n/.)
      5. Publish the pair P D .e; n/ as the participant’s RSA public key.
      6. Keep secret the pair S D .d; n/ as the participant’s RSA secret key.
         For this scheme, the domain D is the set Zn . To transform a message M asso-
      ciated with a public key P D .e; n/, compute
      P .M / D M e mod n :                                                            (31.37)
      To transform a ciphertext C associated with a secret key S D .d; n/, compute
      S.C / D C d mod n :                                                             (31.38)
      These equations apply to both encryption and signatures. To create a signature, the
      signer applies his or her secret key to the message to be signed, rather than to a
      ciphertext. To verify a signature, the public key of the signer is applied to it, rather
      than to a message to be encrypted.
         We can implement the public-key and secret-key operations using the procedure
      M ODULAR -E XPONENTIATION described in Section 31.6. To analyze the running
      time of these operations, assume that the public key .e; n/ and secret key .d; n/
      satisfy lg e D O.1/, lg d  ˇ, and lg n  ˇ. Then, applying a public key requires
      O.1/ modular multiplications and uses O.ˇ 2 / bit operations. Applying a secret
      key requires O.ˇ/ modular multiplications, using O.ˇ 3 / bit operations.

      Theorem 31.36 (Correctness of RSA)
      The RSA equations (31.37) and (31.38) deﬁne inverse transformations of Zn satis-
      fying equations (31.35) and (31.36).
