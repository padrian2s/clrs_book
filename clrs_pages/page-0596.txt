21.4 Analysis of union by rank with path compression                           575


Properties of ranks
In the remainder of this section, we prove an O.m ˛.n// bound on the running time
of the disjoint-set operations with union by rank and path compression. In order to
prove this bound, we ﬁrst prove some simple properties of ranks.

Lemma 21.4
For all nodes x, we have x:rank  x:p:rank, with strict inequality if x ¤ x:p.
The value of x:rank is initially 0 and increases through time until x ¤ x:p; from
then on, x:rank does not change. The value of x:p:rank monotonically increases
over time.

Proof The proof is a straightforward induction on the number of operations, us-
ing the implementations of M AKE -S ET, U NION, and F IND -S ET that appear in
Section 21.3. We leave it as Exercise 21.4-1.

Corollary 21.5
As we follow the simple path from any node toward a root, the node ranks strictly
increase.


Lemma 21.6
Every node has rank at most n  1.

Proof Each node’s rank starts at 0, and it increases only upon L INK operations.
Because there are at most n  1 U NION operations, there are also at most n  1
L INK operations. Because each L INK operation either leaves all ranks alone or
increases some node’s rank by 1, all ranks are at most n  1.

   Lemma 21.6 provides a weak bound on ranks. In fact, every node has rank at
most blg nc (see Exercise 21.4-2). The looser bound of Lemma 21.6 will sufﬁce
for our purposes, however.

Proving the time bound
We shall use the potential method of amortized analysis (see Section 17.3) to prove
the O.m ˛.n// time bound. In performing the amortized analysis, we will ﬁnd it
convenient to assume that we invoke the L INK operation rather than the U NION
operation. That is, since the parameters of the L INK procedure are pointers to two
roots, we act as though we perform the appropriate F IND -S ET operations sepa-
rately. The following lemma shows that even if we count the extra F IND -S ET op-
erations induced by U NION calls, the asymptotic running time remains unchanged.
