654   Chapter 24 Single-Source Shortest Paths


      X
      k                     X
                            k
             i :d                   .i 1 :d C w.i 1 ; i //
      i D1                     i D1

                            X
                            k                      X
                                                   k
                      D               i 1 :d C          w.i 1 ; i / :
                               i D1                i D1

      Since 0 D k , each vertex in c appears exactly once in each of the summations
      Pk               Pk
        i D1 i :d and  i D1 i 1 :d, and so

      X
      k                 X
                        k
             i :d D           i 1 :d :
      i D1              i D1

      Moreover, by Corollary 24.3, i :d is ﬁnite for i D 1; 2; : : : ; k. Thus,
             X
             k
      0            w.i 1 ; i / ;
             i D1

      which contradicts inequality (24.1). We conclude that the Bellman-Ford algorithm
      returns TRUE if graph G contains no negative-weight cycles reachable from the
      source, and FALSE otherwise.

      Exercises

      24.1-1
      Run the Bellman-Ford algorithm on the directed graph of Figure 24.4, using ver-
      tex ´ as the source. In each pass, relax edges in the same order as in the ﬁgure, and
      show the d and  values after each pass. Now, change the weight of edge .´; x/
      to 4 and run the algorithm again, using s as the source.

      24.1-2
      Prove Corollary 24.3.

      24.1-3
      Given a weighted, directed graph G D .V; E/ with no negative-weight cycles,
      let m be the maximum over all vertices  2 V of the minimum number of edges
      in a shortest path from the source s to . (Here, the shortest path is by weight, not
      the number of edges.) Suggest a simple change to the Bellman-Ford algorithm that
      allows it to terminate in m C 1 passes, even if m is not known in advance.

      24.1-4
      Modify the Bellman-Ford algorithm so that it sets :d to 1 for all vertices  for
      which there is a negative-weight cycle on some path from the source to .
