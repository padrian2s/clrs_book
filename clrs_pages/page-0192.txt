7.1 Description of quicksort                                                        171


Combine: Because the subarrays are already sorted, no work is needed to combine
  them: the entire array AŒp : : r is now sorted.
The following procedure implements quicksort:

Q UICKSORT .A; p; r/
1 if p < r
2      q D PARTITION .A; p; r/
3      Q UICKSORT .A; p; q  1/
4      Q UICKSORT .A; q C 1; r/

To sort an entire array A, the initial call is Q UICKSORT .A; 1; A:length/.

Partitioning the array
The key to the algorithm is the PARTITION procedure, which rearranges the subar-
ray AŒp : : r in place.

PARTITION .A; p; r/
1 x D AŒr
2 i D p1
3 for j D p to r  1
4      if AŒj   x
5           i D i C1
6           exchange AŒi with AŒj 
7 exchange AŒi C 1 with AŒr
8 return i C 1

   Figure 7.1 shows how PARTITION works on an 8-element array. PARTITION
always selects an element x D AŒr as a pivot element around which to partition the
subarray AŒp : : r. As the procedure runs, it partitions the array into four (possibly
empty) regions. At the start of each iteration of the for loop in lines 3–6, the regions
satisfy certain properties, shown in Figure 7.2. We state these properties as a loop
invariant:

   At the beginning of each iteration of the loop of lines 3–6, for any array
   index k,
   1. If p  k  i, then AŒk  x.
   2. If i C 1  k  j  1, then AŒk > x.
   3. If k D r, then AŒk D x.
