           24.1 The Bellman-Ford algorithm                                                 651




24.1 The Bellman-Ford algorithm

           The Bellman-Ford algorithm solves the single-source shortest-paths problem in
           the general case in which edge weights may be negative. Given a weighted, di-
           rected graph G D .V; E/ with source s and weight function w W E ! R, the
           Bellman-Ford algorithm returns a boolean value indicating whether or not there is
           a negative-weight cycle that is reachable from the source. If there is such a cy-
           cle, the algorithm indicates that no solution exists. If there is no such cycle, the
           algorithm produces the shortest paths and their weights.
              The algorithm relaxes edges, progressively decreasing an estimate :d on the
           weight of a shortest path from the source s to each vertex  2 V until it achieves
           the actual shortest-path weight ı.s; /. The algorithm returns TRUE if and only if
           the graph contains no negative-weight cycles that are reachable from the source.

           B ELLMAN -F ORD .G; w; s/
           1 I NITIALIZE -S INGLE -S OURCE .G; s/
           2 for i D 1 to jG:Vj  1
           3      for each edge .u; / 2 G:E
           4           R ELAX .u; ; w/
           5 for each edge .u; / 2 G:E
           6      if :d > u:d C w.u; /
           7           return FALSE
           8 return TRUE

               Figure 24.4 shows the execution of the Bellman-Ford algorithm on a graph
           with 5 vertices. After initializing the d and  values of all vertices in line 1,
           the algorithm makes jV j  1 passes over the edges of the graph. Each pass is
           one iteration of the for loop of lines 2–4 and consists of relaxing each edge of the
           graph once. Figures 24.4(b)–(e) show the state of the algorithm after each of the
           four passes over the edges. After making jV j  1 passes, lines 5–8 check for a
           negative-weight cycle and return the appropriate boolean value. (We’ll see a little
           later why this check works.)
               The Bellman-Ford algorithm runs in time O.VE/, since the initialization in
           line 1 takes ‚.V / time, each of the jV j  1 passes over the edges in lines 2–4
           takes ‚.E/ time, and the for loop of lines 5–7 takes O.E/ time.
               To prove the correctness of the Bellman-Ford algorithm, we start by showing that
           if there are no negative-weight cycles, the algorithm computes correct shortest-path
           weights for all vertices reachable from the source.
