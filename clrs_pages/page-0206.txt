           Problems for Chapter 7                                                             185


           7.4-5
           We can improve the running time of quicksort in practice by taking advantage of the
           fast running time of insertion sort when its input is “nearly” sorted. Upon calling
           quicksort on a subarray with fewer than k elements, let it simply return without
           sorting the subarray. After the top-level call to quicksort returns, run insertion sort
           on the entire array to ﬁnish the sorting process. Argue that this sorting algorithm
           runs in O.nk C n lg.n=k// expected time. How should we pick k, both in theory
           and in practice?

           7.4-6 ?
           Consider modifying the PARTITION procedure by randomly picking three elements
           from array A and partitioning about their median (the middle value of the three
           elements). Approximate the probability of getting at worst an ˛-to-.1  ˛/ split, as
           a function of ˛ in the range 0 < ˛ < 1.



Problems

           7-1 Hoare partition correctness
           The version of PARTITION given in this chapter is not the original partitioning
           algorithm. Here is the original partition algorithm, which is due to C. A. R. Hoare:

           H OARE -PARTITION .A; p; r/
            1 x D AŒp
            2 i D p1
            3 j D r C1
            4 while TRUE
            5       repeat
            6            j D j 1
            7       until AŒj   x
            8       repeat
            9            i D i C1
           10       until AŒi  x
           11       if i < j
           12            exchange AŒi with AŒj 
           13       else return j

           a. Demonstrate the operation of H OARE -PARTITION on the array A D h13; 19; 9;
              5; 12; 8; 7; 4; 11; 2; 6; 21i, showing the values of the array and auxiliary values
              after each iteration of the while loop in lines 4–13.
