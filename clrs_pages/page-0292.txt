11.4 Open addressing                                                                271


terminate (unsuccessfully) when it ﬁnds an empty slot, since k would have been
inserted there and not later in its probe sequence. (This argument assumes that keys
are not deleted from the hash table.) The procedure H ASH -S EARCH takes as input
a hash table T and a key k, returning j if it ﬁnds that slot j contains key k, or NIL
if key k is not present in table T .

H ASH -S EARCH .T; k/
1 i D0
2 repeat
3       j D h.k; i/
4       if T Œj  == k
5             return j
6       i D i C1
7 until T Œj  == NIL or i == m
8 return NIL

   Deletion from an open-address hash table is difﬁcult. When we delete a key
from slot i, we cannot simply mark that slot as empty by storing NIL in it. If
we did, we might be unable to retrieve any key k during whose insertion we had
probed slot i and found it occupied. We can solve this problem by marking the
slot, storing in it the special value DELETED instead of NIL. We would then modify
the procedure H ASH -I NSERT to treat such a slot as if it were empty so that we can
insert a new key there. We do not need to modify H ASH -S EARCH, since it will pass
over DELETED values while searching. When we use the special value DELETED,
however, search times no longer depend on the load factor ˛, and for this reason
chaining is more commonly selected as a collision resolution technique when keys
must be deleted.
   In our analysis, we assume uniform hashing: the probe sequence of each key
is equally likely to be any of the mŠ permutations of h0; 1; : : : ; m  1i. Uni-
form hashing generalizes the notion of simple uniform hashing deﬁned earlier to a
hash function that produces not just a single number, but a whole probe sequence.
True uniform hashing is difﬁcult to implement, however, and in practice suitable
approximations (such as double hashing, deﬁned below) are used.
   We will examine three commonly used techniques to compute the probe se-
quences required for open addressing: linear probing, quadratic probing, and dou-
ble hashing. These techniques all guarantee that hh.k; 0/; h.k; 1/; : : : ; h.k; m  1/i
is a permutation of h0; 1; : : : ; m  1i for each key k. None of these techniques ful-
ﬁlls the assumption of uniform hashing, however, since none of them is capable of
generating more than m2 different probe sequences (instead of the mŠ that uniform
hashing requires). Double hashing has the greatest number of probe sequences and,
as one might expect, seems to give the best results.
