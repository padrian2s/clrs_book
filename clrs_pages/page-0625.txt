604   Chapter 22 Elementary Graph Algorithms


      provide important information about the structure of the graph and are generally
      helpful in reasoning about the behavior of depth-ﬁrst search.
        The procedure DFS below records when it discovers vertex u in the attribute u:d
      and when it ﬁnishes vertex u in the attribute u:f . These timestamps are integers
      between 1 and 2 jV j, since there is one discovery event and one ﬁnishing event for
      each of the jV j vertices. For every vertex u,
      u:d < u:f :                                                                     (22.2)
      Vertex u is WHITE before time u:d, GRAY between time u:d and time u:f , and
      BLACK thereafter.
        The following pseudocode is the basic depth-ﬁrst-search algorithm. The input
      graph G may be undirected or directed. The variable time is a global variable that
      we use for timestamping.

      DFS.G/
      1 for each vertex u 2 G:V
      2      u:color D WHITE
      3      u: D NIL
      4 time D 0
      5 for each vertex u 2 G:V
      6      if u:color == WHITE
      7           DFS-V ISIT .G; u/

      DFS-V ISIT .G; u/
       1 time D time C 1                       // white vertex u has just been discovered
       2 u:d D time
       3 u:color D GRAY
       4 for each  2 G:AdjŒu                 // explore edge .u; /
       5      if :color == WHITE
       6           : D u
       7           DFS-V ISIT .G; /
       8 u:color D BLACK                       // blacken u; it is ﬁnished
       9 time D time C 1
      10 u:f D time

      Figure 22.4 illustrates the progress of DFS on the graph shown in Figure 22.2.
         Procedure DFS works as follows. Lines 1–3 paint all vertices white and ini-
      tialize their  attributes to NIL. Line 4 resets the global time counter. Lines 5–7
      check each vertex in V in turn and, when a white vertex is found, visit it using
      DFS-V ISIT. Every time DFS-V ISIT .G; u/ is called in line 7, vertex u becomes
