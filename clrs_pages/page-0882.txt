29.2 Formulating problems as linear programs                                     861


This linear program has jV j2 variables, corresponding to the ﬂow between each
pair of vertices, and it has 2 jV j2 C jV j  2 constraints.
   It is usually more efﬁcient to solve a smaller-sized linear program. The linear
program in (29.47)–(29.50) has, for ease of notation, a ﬂow and capacity of 0 for
each pair of vertices u;  with .u; / 62 E. It would be more efﬁcient to rewrite the
linear program so that it has O.V C E/ constraints. Exercise 29.2-5 asks you to
do so.

Minimum-cost ﬂow
In this section, we have used linear programming to solve problems for which we
already knew efﬁcient algorithms. In fact, an efﬁcient algorithm designed specif-
ically for a problem, such as Dijkstra’s algorithm for the single-source shortest-
paths problem, or the push-relabel method for maximum ﬂow, will often be more
efﬁcient than linear programming, both in theory and in practice.
   The real power of linear programming comes from the ability to solve new prob-
lems. Recall the problem faced by the politician in the beginning of this chapter.
The problem of obtaining a sufﬁcient number of votes, while not spending too
much money, is not solved by any of the algorithms that we have studied in this
book, yet we can solve it by linear programming. Books abound with such real-
world problems that linear programming can solve. Linear programming is also
particularly useful for solving variants of problems for which we may not already
know of an efﬁcient algorithm.
   Consider, for example, the following generalization of the maximum-ﬂow prob-
lem. Suppose that, in addition to a capacity c.u; / for each edge .u; /, we are
given a real-valued cost a.u; /. As in the maximum-ﬂow problem, we assume that
c.u; / D 0 if .u; / 62 E, and that there are no antiparallel edges. If we send fu
units of ﬂow over edge .u; /, we incur a cost of a.u; /fu . We are also given a
ﬂow demand P d . We wish to send d units of ﬂow from s to t while minimizing the
total cost .u;/2E a.u; /fu incurred by the ﬂow. This problem is known as the
minimum-cost-ﬂow problem.
   Figure 29.3(a) shows an example of the minimum-cost-ﬂow problem. We wish
to send 4 units of ﬂow from s to t while incurring the minimum total cost. Any
                       P is, a function f satisfying constraints (29.48)–(29.49),
particular legal ﬂow, that
incurs a total cost of .u;/2E a.u; /fu . We wish to ﬁnd the particular 4-unit
ﬂow P that minimizes this cost. Figure 29.3(b) shows an optimal solution, with total
cost .u;/2E a.u; /fu D .2  2/ C .5  2/ C .3  1/ C .7  1/ C .1  3/ D 27:
   There are polynomial-time algorithms speciﬁcally designed for the minimum-
cost-ﬂow problem, but they are beyond the scope of this book. We can, however,
express the minimum-cost-ﬂow problem as a linear program. The linear program
looks similar to the one for the maximum-ﬂow problem with the additional con-
