512   Chapter 19 Fibonacci Heaps


      F IB -H EAP -U NION .H1 ; H2 /
      1 H D M AKE -F IB -H EAP ./
      2 H:min D H1 :min
      3 concatenate the root list of H2 with the root list of H
      4 if .H1 :min == NIL / or .H2 :min ¤ NIL and H2 :min:key < H1 :min:key/
      5        H:min D H2 :min
      6 H:n D H1 :n C H2 :n
      7 return H

      Lines 1–3 concatenate the root lists of H1 and H2 into a new root list H . Lines
      2, 4, and 5 set the minimum node of H , and line 6 sets H:n to the total number
      of nodes. Line 7 returns the resulting Fibonacci heap H . As in the F IB -H EAP -
      I NSERT procedure, all roots remain roots.
         The change in potential is
      ˆ.H /  .ˆ.H1 / C ˆ.H2 //
            D .t.H / C 2 m.H //  ..t.H1 / C 2 m.H1 // C .t.H2 / C 2 m.H2 ///
            D 0;
      because t.H / D t.H1 / C t.H2 / and m.H / D m.H1 / C m.H2 /. The amortized
      cost of F IB -H EAP -U NION is therefore equal to its O.1/ actual cost.

      Extracting the minimum node
      The process of extracting the minimum node is the most complicated of the oper-
      ations presented in this section. It is also where the delayed work of consolidating
      trees in the root list ﬁnally occurs. The following pseudocode extracts the mini-
      mum node. The code assumes for convenience that when a node is removed from
      a linked list, pointers remaining in the list are updated, but pointers in the extracted
      node are left unchanged. It also calls the auxiliary procedure C ONSOLIDATE ,
      which we shall see shortly.
