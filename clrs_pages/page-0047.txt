26   Chapter 2 Getting Started


     I NSERTION -S ORT .A/                                 cost      times
     1 for j D 2 to A:length                               c1        n
     2     key D AŒj                                      c2        n1
     3     // Insert AŒj  into the sorted
                sequence AŒ1 : : j  1.                   0         n1
     4     i D j 1                                        c4        n
                                                                     P 1
                                                                        n
     5     while i > 0 and AŒi > key                      c5             t
                                                                     PjnD2 j
     6          AŒi C 1 D AŒi                            c6             .t  1/
                                                                     PjnD2 j
     7           i D i 1                                  c7         j D2 j  1/
                                                                          .t
     8     AŒi C 1 D key                                  c8        n1

        The running time of the algorithm is the sum of running times for each state-
     ment executed; a statement that takes ci steps to execute and executes n times will
     contribute ci n to the total running time.6 To compute T .n/, the running time of
     I NSERTION -S ORT on an input of n values, we sum the products of the cost and
     times columns, obtaining
                                                            X
                                                            n                X
                                                                             n
     T .n/ D c1 n C c2 .n  1/ C c4 .n  1/ C c5                   tj C c6     .tj  1/
                                                            j D2             j D2

                          X
                          n
                   C c7          .tj  1/ C c8 .n  1/ :
                          j D2

        Even for inputs of a given size, an algorithm’s running time may depend on
     which input of that size is given. For example, in I NSERTION -S ORT, the best
     case occurs if the array is already sorted. For each j D 2; 3; : : : ; n, we then ﬁnd
     that AŒi  key in line 5 when i has its initial value of j  1. Thus tj D 1 for
     j D 2; 3; : : : ; n, and the best-case running time is
     T .n/ D c1 n C c2 .n  1/ C c4 .n  1/ C c5 .n  1/ C c8 .n  1/
           D .c1 C c2 C c4 C c5 C c8 /n  .c2 C c4 C c5 C c8 / :
     We can express this running time as an C b for constants a and b that depend on
     the statement costs ci ; it is thus a linear function of n.
        If the array is in reverse sorted order—that is, in decreasing order—the worst
     case results. We must compare each element AŒj  with each element in the entire
     sorted subarray AŒ1 : : j  1, and so tj D j for j D 2; 3; : : : ; n. Noting that


     6 This characteristic does not necessarily hold for a resource such as memory. A statement that

     references m words of memory and is executed n times does not necessarily reference mn distinct
     words of memory.
