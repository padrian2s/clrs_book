690   Chapter 25 All-Pairs Shortest Paths


                         2
               3                   4

       1                                     3
               2                   8

        –4                                 –5
                   7           1
               5                   4
                         6

                0 3           8       1         4
                                                      ˘            0       3       8       2       4
                                                                                                         ˘
                    1     0   1         1         7                  3      0      4       1        7
      L.1/ D        1     4    0       1         1        L.2/ D    1       4       0       5       11
                     2   1    5        0        1                   2     1      5       0       2
                    1    1    1         6         0                  8     1        1       6        0

                0        3   3       2    4
                                                  ˘                0      1      3    2       4
                                                                                                     ˘
                    3     0   4       1    1                      3      0      4    1       1
      L.3/ D        7     4    0       5    11            L.4/ D    7      4       0    5        3
                    2    1   5       0    2                      2     1      5    0       2
                    8     5    1       6     0                      8      5       1    6        0


      Figure 25.1 A directed graph and the sequence of matrices L.m/ computed by S LOW-A LL -PAIRS -
      S HORTEST-PATHS. You might want to verify that L.5/ , deﬁned as L.4/  W , equals L.4/ , and thus
      L.m/ D L.4/ for all m  4.


      tion (25.3) implies L.m/ D L.n1/ for all integers m  n  1. Just as tradi-
      tional matrix multiplication is associative, so is matrix multiplication deﬁned by
      the E XTEND -S HORTEST-PATHS procedure (see Exercise 25.1-4). Therefore, we
      can compute L.n1/ with only dlg.n  1/e matrix products by computing the se-
      quence
               L.1/      D         W ;
               L.2/      D         W2             D W W ;
               L.4/      D         W4             D W2W2
               L.8/      D         W8             D W4W4 ;
                                    ::
                                     :
           dlg.n1/e /             dlg.n1/e                dlg.n1/e1          dlg.n1/e1
      L.2                D W2                     D W2                    W2                   :
                                                                     dlg.n1/e
      Since 2dlg.n1/e  n  1, the ﬁnal product L.2   /
                                                         is equal to L.n1/ .
         The following procedure computes the above sequence of matrices by using this
      technique of repeated squaring.
