Problems for Chapter 17                                                        475


We shall ﬁrst analyze the structural modiﬁcations when only insertions are per-
formed. Let T be a red-black tree, and deﬁne ˆ.T / to be the number of red nodes
in T . Assume that 1 unit of potential can pay for the structural modiﬁcations per-
formed by any of the three cases of RB-I NSERT-F IXUP.

c. Let T 0 be the result of applying Case 1 of RB-I NSERT-F IXUP to T . Argue that
   ˆ.T 0 / D ˆ.T /  1.

d. When we insert a node into a red-black tree using RB-I NSERT, we can break
   the operation into three parts. List the structural modiﬁcations and potential
   changes resulting from lines 1–16 of RB-I NSERT, from nonterminating cases
   of RB-I NSERT-F IXUP, and from terminating cases of RB-I NSERT-F IXUP.

e. Using part (d), argue that the amortized number of structural modiﬁcations per-
   formed by any call of RB-I NSERT is O.1/.

We now wish to prove that there are O.m/ structural modiﬁcations when there are

         „ 0 if x is red ;
both insertions and deletions. Let us deﬁne, for each node x,


            1 if x is black and has no red children ;
w.x/ D
            0 if x is black and has one red child ;
            2 if x is black and has two red children :
Now we redeﬁne the potential of a red-black tree T as
        X
ˆ.T / D    w.x/ ;
          x2T

and let T 0 be the tree that results from applying any nonterminating case of RB-
I NSERT-F IXUP or RB-D ELETE -F IXUP to T .

f. Show that ˆ.T 0 /  ˆ.T /  1 for all nonterminating cases of RB-I NSERT-
   F IXUP. Argue that the amortized number of structural modiﬁcations performed
   by any call of RB-I NSERT-F IXUP is O.1/.

g. Show that ˆ.T 0 /  ˆ.T /  1 for all nonterminating cases of RB-D ELETE -
   F IXUP. Argue that the amortized number of structural modiﬁcations performed
   by any call of RB-D ELETE -F IXUP is O.1/.

h. Complete the proof that in the worst case, any sequence of m RB-I NSERT and
   RB-D ELETE operations performs O.m/ structural modiﬁcations.
