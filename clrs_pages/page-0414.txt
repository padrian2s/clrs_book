15.4 Longest common subsequence                                                       393


sive solution also has the overlapping-subproblems property, as we shall see in a
moment.

Step 2: A recursive solution
Theorem 15.1 implies that we should examine either one or two subproblems when
ﬁnding an LCS of X D hx1 ; x2 ; : : : ; xm i and Y D hy1 ; y2 ; : : : ; yn i. If xm D yn ,
we must ﬁnd an LCS of Xm1 and Yn1 . Appending xm D yn to this LCS yields
an LCS of X and Y . If xm ¤ yn , then we must solve two subproblems: ﬁnding an
LCS of Xm1 and Y and ﬁnding an LCS of X and Yn1 . Whichever of these two
LCSs is longer is an LCS of X and Y . Because these cases exhaust all possibilities,
we know that one of the optimal subproblem solutions must appear within an LCS
of X and Y .
   We can readily see the overlapping-subproblems property in the LCS problem.
To ﬁnd an LCS of X and Y , we may need to ﬁnd the LCSs of X and Yn1 and
of Xm1 and Y . But each of these subproblems has the subsubproblem of ﬁnding
an LCS of Xm1 and Yn1 . Many other subproblems share subsubproblems.
   As in the matrix-chain multiplication problem, our recursive solution to the LCS
problem involves establishing a recurrence for the value of an optimal solution.
Let us deﬁne cŒi; j  to be the length of an LCS of the sequences Xi and Yj . If
either i D 0 or j D 0, one of the sequences has length 0, and so the LCS has

             0
length 0. The optimal substructure of the LCS problem gives the recursive formula

                                             if i D 0 or j D 0 ;
cŒi; j  D    cŒi  1; j  1 C 1            if i; j > 0 and xi D yj ;             (15.9)
              max.cŒi; j  1; cŒi  1; j / if i; j > 0 and xi ¤ yj :
   Observe that in this recursive formulation, a condition in the problem restricts
which subproblems we may consider. When xi D yj , we can and should consider
the subproblem of ﬁnding an LCS of Xi 1 and Yj 1 . Otherwise, we instead con-
sider the two subproblems of ﬁnding an LCS of Xi and Yj 1 and of Xi 1 and Yj . In
the previous dynamic-programming algorithms we have examined—for rod cutting
and matrix-chain multiplication—we ruled out no subproblems due to conditions
in the problem. Finding an LCS is not the only dynamic-programming algorithm
that rules out subproblems based on conditions in the problem. For example, the
edit-distance problem (see Problem 15-5) has this characteristic.

Step 3: Computing the length of an LCS
Based on equation (15.9), we could easily write an exponential-time recursive al-
gorithm to compute the length of an LCS of two sequences. Since the LCS problem
