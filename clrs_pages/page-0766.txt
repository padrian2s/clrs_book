26.4 Push-relabel algorithms                                                         745


relabeled, it is overﬂowing, and Lemma 26.19 tells us that there is a simple path p
from u to s in Gf . Let p D h0 ; 1 ; : : : ; k i, where 0 D u, k D s, and k  jV j1
because p is simple. For i D 0; 1; : : : ; k  1, we have .i ; i C1 / 2 Ef , and
therefore, by Lemma 26.16, i :h  i C1 :h C 1. Expanding these inequalities over
path p yields u:h D 0 :h  k :h C k  s:h C .jV j  1/ D 2 jV j  1.


Corollary 26.21 (Bound on relabel operations)
Let G D .V; E/ be a ﬂow network with source s and sink t. Then, during the
execution of G ENERIC -P USH -R ELABEL on G, the number of relabel operations is
at most 2 jV j  1 per vertex and at most .2 jV j  1/.jV j  2/ < 2 jV j2 overall.

Proof Only the jV j2 vertices in V fs; tg may be relabeled. Let u 2 V fs; tg.
The operation R ELABEL .u/ increases u:h. The value of u:h is initially 0 and by
Lemma 26.20, it grows to at most 2 jV j  1. Thus, each vertex u 2 V  fs; tg
is relabeled at most 2 jV j  1 times, and the total number of relabel operations
performed is at most .2 jV j  1/.jV j  2/ < 2 jV j2 .

  Lemma 26.20 also helps us to bound the number of saturating pushes.

Lemma 26.22 (Bound on saturating pushes)
During the execution of G ENERIC -P USH -R ELABEL on any ﬂow network G D
.V; E/, the number of saturating pushes is less than 2 jV j jEj.

Proof For any pair of vertices u;  2 V , we will count the saturating pushes
from u to  and from  to u together, calling them the saturating pushes between u
and . If there are any such pushes, at least one of .u; / and .; u/ is actually
an edge in E. Now, suppose that a saturating push from u to  has occurred.
At that time, :h D u:h  1. In order for another push from u to  to occur
later, the algorithm must ﬁrst push ﬂow from  to u, which cannot happen until
:h D u:h C 1. Since u:h never decreases, in order for :h D u:h C 1, the
value of :h must increase by at least 2. Likewise, u:h must increase by at least 2
between saturating pushes from  to u. Heights start at 0 and, by Lemma 26.20,
never exceed 2 jV j  1, which implies that the number of times any vertex can have
its height increase by 2 is less than jV j. Since at least one of u:h and :h must
increase by 2 between any two saturating pushes between u and , there are fewer
than 2 jV j saturating pushes between u and . Multiplying by the number of edges
gives a bound of less than 2 jV j jEj on the total number of saturating pushes.

  The following lemma bounds the number of nonsaturating pushes in the generic
push-relabel algorithm.
