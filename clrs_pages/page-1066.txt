Problems for Chapter 33                                                             1045


33-2 Maximal layers
Let Q be a set of n points in the plane. We say that point .x; y/ dominates
point .x 0 ; y 0 / if x  x 0 and y  y 0 . A point in Q that is dominated by no other
points in Q is said to be maximal. Note that Q may contain many maximal points,
which can be organized into maximal layers as follows. The ﬁrst maximal layer L1
is the set of maximal points Si 1of Q. For i > 1, the ith maximal layer Li is the set of
maximal points in Q  j D1 Lj .
   Suppose that Q has k nonempty maximal layers, and let yi be the y-coordinate
of the leftmost point in Li for i D 1; 2; : : : ; k. For now, assume that no two points
in Q have the same x- or y-coordinate.
a. Show that y1 > y2 >    > yk .
Consider a point .x; y/ that is to the left of any point in Q and for which y is
distinct from the y-coordinate of any point in Q. Let Q0 D Q [ f.x; y/g.
b. Let j be the minimum index such that yj < y, unless y < yk , in which case
   we let j D k C 1. Show that the maximal layers of Q0 are as follows:
      If j  k, then the maximal layers of Q0 are the same as the maximal layers
       of Q, except that Lj also includes .x; y/ as its new leftmost point.
      If j D k C 1, then the ﬁrst k maximal layers of Q0 are the same as for Q, but
       in addition, Q0 has a nonempty .k C 1/st maximal layer: LkC1 D f.x; y/g.

c. Describe an O.n lg n/-time algorithm to compute the maximal layers of a set Q
   of n points. (Hint: Move a sweep line from right to left.)

d. Do any difﬁculties arise if we now allow input points to have the same x- or
   y-coordinate? Suggest a way to resolve such problems.

33-3 Ghostbusters and ghosts
A group of n Ghostbusters is battling n ghosts. Each Ghostbuster carries a proton
pack, which shoots a stream at a ghost, eradicating it. A stream goes in a straight
line and terminates when it hits the ghost. The Ghostbusters decide upon the fol-
lowing strategy. They will pair off with the ghosts, forming n Ghostbuster-ghost
pairs, and then simultaneously each Ghostbuster will shoot a stream at his cho-
sen ghost. As we all know, it is very dangerous to let streams cross, and so the
Ghostbusters must choose pairings for which no streams will cross.
   Assume that the position of each Ghostbuster and each ghost is a ﬁxed point in
the plane and that no three positions are colinear.
a. Argue that there exists a line passing through one Ghostbuster and one ghost
   such that the number of Ghostbusters on one side of the line equals the number
   of ghosts on the same side. Describe how to ﬁnd such a line in O.n lg n/ time.
