22.2 Breadth-ﬁrst search                                                         601


path from s to  that is also a shortest path from s to  in G. A breadth-ﬁrst tree
is in fact a tree, since it is connected and jE j D jV j  1 (see Theorem B.2). We
call the edges in E tree edges.
   The following lemma shows that the predecessor subgraph produced by the BFS
procedure is a breadth-ﬁrst tree.

Lemma 22.6
When applied to a directed or undirected graph G D .V; E/, procedure BFS con-
structs  so that the predecessor subgraph G D .V ; E / is a breadth-ﬁrst tree.

Proof Line 16 of BFS sets : D u if and only if .u; / 2 E and ı.s; / < 1—
that is, if  is reachable from s—and thus V consists of the vertices in V reachable
from s. Since G forms a tree, by Theorem B.2, it contains a unique simple path
from s to each vertex in V . By applying Theorem 22.5 inductively, we conclude
that every such path is a shortest path in G.

  The following procedure prints out the vertices on a shortest path from s to ,
assuming that BFS has already computed a breadth-ﬁrst tree:

P RINT-PATH .G; s; /
1 if  == s
2       print s
3 elseif : == NIL
4       print “no path from” s “to”  “exists”
5 else P RINT-PATH .G; s; :/
6       print 

This procedure runs in time linear in the number of vertices in the path printed,
since each recursive call is for a path one vertex shorter.

Exercises

22.2-1
Show the d and  values that result from running breadth-ﬁrst search on the di-
rected graph of Figure 22.2(a), using vertex 3 as the source.

22.2-2
Show the d and  values that result from running breadth-ﬁrst search on the undi-
rected graph of Figure 22.3, using vertex u as the source.
