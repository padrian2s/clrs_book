9.2 Selection in expected linear time                                         219

                                                    
                2c .n  1/n .bn=2c  1/ bn=2c
            D                                         C an
                n          2               2
                                                     
                2c .n  1/n .n=2  2/.n=2  1/
                                                      C an
                n          2               2
                                                 
                2c n2  n n2 =4  3n=2 C 2
           D                                       C an
                n        2               2
                   2               
                c 3n          n
           D              C  2 C an
                n     4       2
                                  
                    3n      1 2
           D c          C           C an
                     4      2 n
                3cn c
                     C C an
                 4 2                 
                        cn c
           D cn               an :
                         4      2
In order to complete the proof, we need to show that for sufﬁciently large n, this
last expression is at most cn or, equivalently, that cn=4  c=2  an  0. If we
add c=2 to both sides and factor out n, we get n.c=4  a/  c=2. As long as we
choose the constant c so that c=4  a > 0, i.e., c > 4a, we can divide both sides
by c=4  a, giving
       c=2       2c
n           D        :
     c=4  a   c  4a
Thus, if we assume that T .n/ D O.1/ for n < 2c=.c 4a/, then E ŒT .n/ D O.n/.
We conclude that we can ﬁnd any order statistic, and in particular the median, in
expected linear time, assuming that the elements are distinct.

Exercises

9.2-1
Show that R ANDOMIZED -S ELECT never makes a recursive call to a 0-length array.

9.2-2
Argue that the indicator random variable Xk and the value T .max.k  1; n  k//
are independent.

9.2-3
Write an iterative version of R ANDOMIZED -S ELECT.
