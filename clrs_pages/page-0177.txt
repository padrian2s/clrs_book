156          Chapter 6 Heapsort


             The solution to this recurrence, by case 2 of the master theorem (Theorem 4.1),
             is T .n/ D O.lg n/. Alternatively, we can characterize the running time of M AX -
             H EAPIFY on a node of height h as O.h/.

             Exercises

             6.2-1
             Using Figure 6.2 as a model, illustrate the operation of M AX -H EAPIFY .A; 3/ on
             the array A D h27; 17; 3; 16; 13; 10; 1; 5; 7; 12; 4; 8; 9; 0i.

             6.2-2
             Starting with the procedure M AX -H EAPIFY, write pseudocode for the procedure
             M IN -H EAPIFY .A; i/, which performs the corresponding manipulation on a min-
             heap. How does the running time of M IN -H EAPIFY compare to that of M AX -
             H EAPIFY?

             6.2-3
             What is the effect of calling M AX -H EAPIFY .A; i/ when the element AŒi is larger
             than its children?

             6.2-4
             What is the effect of calling M AX -H EAPIFY .A; i/ for i > A:heap-size=2?

             6.2-5
             The code for M AX -H EAPIFY is quite efﬁcient in terms of constant factors, except
             possibly for the recursive call in line 10, which might cause some compilers to
             produce inefﬁcient code. Write an efﬁcient M AX -H EAPIFY that uses an iterative
             control construct (a loop) instead of recursion.

             6.2-6
             Show that the worst-case running time of M AX -H EAPIFY on a heap of size n
             is .lg n/. (Hint: For a heap with n nodes, give node values that cause M AX -
             H EAPIFY to be called recursively at every node on a simple path from the root
             down to a leaf.)



6.3   Building a heap

             We can use the procedure M AX -H EAPIFY in a bottom-up manner to convert an
             array AŒ1 : : n, where n D A:length, into a max-heap. By Exercise 6.1-7, the
             elements in the subarray AŒ.bn=2cC1/ : : n are all leaves of the tree, and so each is
