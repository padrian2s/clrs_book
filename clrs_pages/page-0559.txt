538   Chapter 20 van Emde Boas Trees


                                                                      p
        proto-EB.u/                              0   1   2   3   …    u1
      u        summary                 cluster


                         p
               proto-EB. u/ structure           p            p
                                                  u proto-EB. u/ structures


      Figure 20.3 The information in a proto-EB.u/ structure
                                                         p       when u  4. The structure containsp the
      universe
        p      size u, a pointer summary
                                    p    to a proto-EB.  u/ structure, and an array clusterŒ0 : :  u  1
      of u pointers to proto-EB. u/ structures.


      always be the universe size of the data structure in which we call the function,
      which changes as we descend into the recursive structure.

      20.2.1    Proto van Emde Boas structures
      Taking our cue from recurrence (20.2), let us design a recursive data structure to
      support the operations. Although this data structure will fail to achieve our goal of
      O.lg lg u/ time for some operations, it serves as a basis for the van Emde Boas tree
      structure that we will see in Section 20.3.
         For the universe f0; 1; 2; : : : ; u  1g, we deﬁne a proto van Emde Boas struc-
      ture, or proto-vEB structure, which we denote as proto-EB.u/, recursively as
      follows. Each proto-EB.u/ structure contains an attribute u giving its universe
      size. In addition, it contains the following:
         If u D 2, then it is the base size, and it contains an array AŒ0 : : 1 of two bits.
                                   k
         Otherwise, u D 22 for some integer k  1, so that u  4. In addition
          to the universe size u, the data structure proto-EB.u/ contains the following
          attributes, illustrated in Figure 20.3:
                                                        p
            a pointer named summary to a proto-EB. u/ structure and
                                    p          p                              p
            an array clusterŒ0 : : u1 of u pointers, each to a proto-EB. u/ struc-
             ture.
      The element x, where 0  x < u, is recursively stored in the cluster numbered
      high.x/ as element low.x/ within that cluster.
         In the two-level
                    p structure of the previous section, each node stores a summary
      array of size u, in which each entry contains a bit. From thepindex of each
      entry, we can compute the starting index of the subarray of size u that the bit
      summarizes. In the proto-vEB structure, we use explicit pointers rather than index
