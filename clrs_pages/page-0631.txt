610   Chapter 22 Elementary Graph Algorithms


      an edge that reaches another gray vertex has reached an ancestor. The third case
      handles the remaining possibility; Exercise 22.3-5 asks you to show that such an
      edge .u; / is a forward edge if u:d < :d and a cross edge if u:d > :d.
         An undirected graph may entail some ambiguity in how we classify edges,
      since .u; / and .; u/ are really the same edge. In such a case, we classify the
      edge as the ﬁrst type in the classiﬁcation list that applies. Equivalently (see Ex-
      ercise 22.3-6), we classify the edge according to whichever of .u; / or .; u/ the
      search encounters ﬁrst.
         We now show that forward and cross edges never occur in a depth-ﬁrst search of
      an undirected graph.

      Theorem 22.10
      In a depth-ﬁrst search of an undirected graph G, every edge of G is either a tree
      edge or a back edge.

      Proof Let .u; / be an arbitrary edge of G, and suppose without loss of generality
      that u:d < :d. Then the search must discover and ﬁnish  before it ﬁnishes u
      (while u is gray), since  is on u’s adjacency list. If the ﬁrst time that the search
      explores edge .u; /, it is in the direction from u to , then  is undiscovered
      (white) until that time, for otherwise the search would have explored this edge
      already in the direction from  to u. Thus, .u; / becomes a tree edge. If the
      search explores .u; / ﬁrst in the direction from  to u, then .u; / is a back edge,
      since u is still gray at the time the edge is ﬁrst explored.

        We shall see several applications of these theorems in the following sections.

      Exercises

      22.3-1
      Make a 3-by-3 chart with row and column labels WHITE, GRAY, and BLACK. In
      each cell .i; j /, indicate whether, at any point during a depth-ﬁrst search of a di-
      rected graph, there can be an edge from a vertex of color i to a vertex of color j .
      For each possible edge, indicate what edge types it can be. Make a second such
      chart for depth-ﬁrst search of an undirected graph.

      22.3-2
      Show how depth-ﬁrst search works on the graph of Figure 22.6. Assume that the
      for loop of lines 5–7 of the DFS procedure considers the vertices in alphabetical
      order, and assume that each adjacency list is ordered alphabetically. Show the
      discovery and ﬁnishing times for each vertex, and show the classiﬁcation of each
      edge.
