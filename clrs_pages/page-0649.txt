628   Chapter 23 Minimum Spanning Trees




                                x


                                 p
       u
                                        y




                  v



      Figure 23.3 The proof of Theorem 23.1. Black vertices are in S, and white vertices are in V  S.
      The edges in the minimum spanning tree T are shown, but the edges in the graph G are not. The
      edges in A are shaded, and .u; / is a light edge crossing the cut .S; V  S/. The edge .x; y/ is
      an edge on the unique simple path p from u to  in T . To form a minimum spanning tree T 0 that
      contains .u; /, remove the edge .x; y/ from T and add the edge .u; /.


      But T is a minimum spanning tree, so that w.T /  w.T 0 /; thus, T 0 must be a
      minimum spanning tree also.
         It remains to show that .u; / is actually a safe edge for A. We have A  T 0 ,
      since A  T and .x; y/ 62 A; thus, A [ f.u; /g  T 0 . Consequently, since T 0 is a
      minimum spanning tree, .u; / is safe for A.

         Theorem 23.1 gives us a better understanding of the workings of the G ENERIC -
      MST method on a connected graph G D .V; E/. As the method proceeds, the
      set A is always acyclic; otherwise, a minimum spanning tree including A would
      contain a cycle, which is a contradiction. At any point in the execution, the graph
      GA D .V; A/ is a forest, and each of the connected components of GA is a tree.
      (Some of the trees may contain just one vertex, as is the case, for example, when
      the method begins: A is empty and the forest contains jV j trees, one for each
      vertex.) Moreover, any safe edge .u; / for A connects distinct components of GA ,
      since A [ f.u; /g must be acyclic.
         The while loop in lines 2–4 of G ENERIC -MST executes jV j  1 times because
      it ﬁnds one of the jV j  1 edges of a minimum spanning tree in each iteration.
      Initially, when A D ;, there are jV j trees in GA , and each iteration reduces that
      number by 1. When the forest contains only a single tree, the method terminates.
         The two algorithms in Section 23.2 use the following corollary to Theorem 23.1.
