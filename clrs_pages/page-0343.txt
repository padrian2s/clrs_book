322   Chapter 13 Red-Black Trees


      Having shown that each iteration of the loop maintains the invariant, we have
      shown that RB-I NSERT-F IXUP correctly restores the red-black properties.

      Analysis
      What is the running time of RB-I NSERT? Since the height of a red-black tree on n
      nodes is O.lg n/, lines 1–16 of RB-I NSERT take O.lg n/ time. In RB-I NSERT-
      F IXUP, the while loop repeats only if case 1 occurs, and then the pointer ´ moves
      two levels up the tree. The total number of times the while loop can be executed
      is therefore O.lg n/. Thus, RB-I NSERT takes a total of O.lg n/ time. Moreover, it
      never performs more than two rotations, since the while loop terminates if case 2
      or case 3 is executed.

      Exercises

      13.3-1
      In line 16 of RB-I NSERT, we set the color of the newly inserted node ´ to red.
      Observe that if we had chosen to set ´’s color to black, then property 4 of a red-
      black tree would not be violated. Why didn’t we choose to set ´’s color to black?

      13.3-2
      Show the red-black trees that result after successively inserting the keys 41; 38; 31;
      12; 19; 8 into an initially empty red-black tree.

      13.3-3
      Suppose that the black-height of each of the subtrees ˛; ˇ; ; ı; " in Figures 13.5
      and 13.6 is k. Label each node in each ﬁgure with its black-height to verify that
      the indicated transformation preserves property 5.

      13.3-4
      Professor Teach is concerned that RB-I NSERT-F IXUP might set T:nil:color to
      RED , in which case the test in line 1 would not cause the loop to terminate when ´
      is the root. Show that the professor’s concern is unfounded by arguing that RB-
      I NSERT-F IXUP never sets T:nil:color to RED.

      13.3-5
      Consider a red-black tree formed by inserting n nodes with RB-I NSERT. Argue
      that if n > 1, the tree has at least one red node.

      13.3-6
      Suggest how to implement RB-I NSERT efﬁciently if the representation for red-
      black trees includes no storage for parent pointers.
