620   Chapter 22 Elementary Graph Algorithms


      in any strongly connected component other than C will be a descendant of u during
      the depth-ﬁrst search of G T . Thus, the vertices of the depth-ﬁrst tree in G T that is
      rooted at u form exactly one strongly connected component, which completes the
      inductive step and the proof.

         Here is another way to look at how the second depth-ﬁrst search operates. Con-
      sider the component graph .G T /SCC of G T . If we map each strongly connected
      component visited in the second depth-ﬁrst search to a vertex of .G T /SCC , the sec-
      ond depth-ﬁrst search visits vertices of .G T /SCC in the reverse of a topologically
      sorted order. If we reverse the edges of .G T /SCC , we get the graph ..G T /SCC /T .
      Because ..G T /SCC /T D G SCC (see Exercise 22.5-4), the second depth-ﬁrst search
      visits the vertices of G SCC in topologically sorted order.

      Exercises

      22.5-1
      How can the number of strongly connected components of a graph change if a new
      edge is added?

      22.5-2
      Show how the procedure S TRONGLY-C ONNECTED -C OMPONENTS works on the
      graph of Figure 22.6. Speciﬁcally, show the ﬁnishing times computed in line 1 and
      the forest produced in line 3. Assume that the loop of lines 5–7 of DFS considers
      vertices in alphabetical order and that the adjacency lists are in alphabetical order.

      22.5-3
      Professor Bacon claims that the algorithm for strongly connected components
      would be simpler if it used the original (instead of the transpose) graph in the
      second depth-ﬁrst search and scanned the vertices in order of increasing ﬁnishing
      times. Does this simpler algorithm always produce correct results?

      22.5-4
      Prove that for any directed graph G, we have ..G T /SCC /T D G SCC . That is, the
      transpose of the component graph of G T is the same as the component graph of G.

      22.5-5
      Give an O.V C E/-time algorithm to compute the component graph of a directed
      graph G D .V; E/. Make sure that there is at most one edge between two vertices
      in the component graph your algorithm produces.
