                   4.6 Proof of the master theorem                                                                                       99


                                                           f .n/                                                                      f .n/

                                                                   a


                   f .n=b/                           f .n=b/                 …              f .n=b/                              af .n=b/

                         a                                 a                                      a
logb n
         f .n=b 2 / f .n=b 2 /…f .n=b 2 / f .n=b 2 / f .n=b 2 /…f .n=b 2 /       f .n=b 2 / f .n=b 2 /…f .n=b 2 /              a2 f .n=b 2 /

              a        a           a            a        a             a              a         a          a
              …        …           …            …        …             …              …         …          …
                                                                                                                                    …

     ‚.1/ ‚.1/ ‚.1/ ‚.1/ ‚.1/ ‚.1/ ‚.1/ ‚.1/ ‚.1/ ‚.1/                              …        ‚.1/ ‚.1/ ‚.1/                     ‚.nlogb a /


                                                        nlogb a
                                                                                                                     X
                                                                                                                    logb n1

                                                                                           Total: ‚.nlogb a / C                aj f .n=b j /
                                                                                                                     j D0




                   Figure 4.7 The recursion tree generated by T .n/ D aT .n=b/ C f .n/. The tree is a complete a-ary
                   tree with nlogb a leaves and height logb n. The cost of the nodes at each depth is shown at the right,
                   and their sum is given in equation (4.21).


                   an integer, especially when visualizing the recursion tree, but the mathematics does
                   not require it.) Each of these children has a children, making a2 nodes at depth 2,
                   and each of the a children has cost f .n=b 2 /. In general, there are aj nodes at
                   depth j , and each has cost f .n=b j /. The cost of each leaf is T .1/ D ‚.1/, and
                   each leaf is at depth logb n, since n=b logb n D 1. There are alogb n D nlogb a leaves
                   in the tree.
                      We can obtain equation (4.21) by summing the costs of the nodes at each depth
                   in the tree, as shown in the ﬁgure. The cost for all internal nodes at depth j is
                   aj f .n=b j /, and so the total cost of all internal nodes is
                      X
                   logb n1

                              aj f .n=b j / :
                     j D0

                   In the underlying divide-and-conquer algorithm, this sum represents the costs of
                   dividing problems into subproblems and then recombining the subproblems. The
