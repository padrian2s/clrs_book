532        Chapter 20 van Emde Boas Trees


           operation, we will implement the simpler operation M EMBER .S; x/, which returns
           a boolean indicating whether the value x is currently in dynamic set S.
              So far, we have used the parameter n for two distinct purposes: the number of
           elements in the dynamic set, and the range of the possible values. To avoid any
           further confusion, from here on we will use n to denote the number of elements
           currently in the set and u as the range of possible values, so that each van Emde
           Boas tree operation runs in O.lg lg u/ time. We call the set f0; 1; 2; : : : ; u  1g
           the universe of values that can be stored and u the universe size. We assume
           throughout this chapter that u is an exact power of 2, i.e., u D 2k for some integer
           k  1.
              Section 20.1 starts us out by examining some simple approaches that will get
           us going in the right direction. We enhance these approaches in Section 20.2,
           introducing proto van Emde Boas structures, which are recursive but do not achieve
           our goal of O.lg lg u/-time operations. Section 20.3 modiﬁes proto van Emde Boas
           structures to develop van Emde Boas trees, and it shows how to implement each
           operation in O.lg lg u/ time.


20.1 Preliminary approaches

           In this section, we shall examine various approaches for storing a dynamic set.
           Although none will achieve the O.lg lg u/ time bounds that we desire, we will gain
           insights that will help us understand van Emde Boas trees when we see them later
           in this chapter.

           Direct addressing
           Direct addressing, as we saw in Section 11.1, provides the simplest approach to
           storing a dynamic set. Since in this chapter we are concerned only with storing
           keys, we can simplify the direct-addressing approach to store the dynamic set as a
           bit vector, as discussed in Exercise 11.1-2. To store a dynamic set of values from
           the universe f0; 1; 2; : : : ; u  1g, we maintain an array AŒ0 : : u  1 of u bits. The
           entry AŒx holds a 1 if the value x is in the dynamic set, and it holds a 0 otherwise.
           Although we can perform each of the I NSERT, D ELETE, and M EMBER operations
           in O.1/ time with a bit vector, the remaining operations—M INIMUM, M AXIMUM,
           S UCCESSOR, and P REDECESSOR—each take ‚.u/ time in the worst case because
