20.3 The van Emde Boas tree                                                       549


This recurrence looks similar to recurrence (20.2), and we will solve it in a similar
fashion. Letting m D lg u, we rewrite it as
T .2m /  T .2dm=2e / C O.1/ :
Noting that dm=2e  2m=3 for all m  2, we have
T .2m /  T .22m=3 / C O.1/ :
Letting S.m/ D T .2m /, we rewrite this last recurrence as
S.m/  S.2m=3/ C O.1/ ;
which, by case 2 of the master method, has the solution S.m/ D O.lg m/. (In
terms of the asymptotic solution, the fraction 2=3 does not make any difference
compared with the fraction 1=2, because when we apply the master method, we
ﬁnd that log3=2 1 D log2 1 D 0:) Thus, we have T .u/ D T .2m / D S.m/ D
O.lg m/ D O.lg lg u/.
   Before using a van Emde Boas tree, we must know the universe size u, so that
we can create a van Emde Boas tree of the appropriate size that initially represents
an empty set. As Problem 20-1 asks you to show, the total space requirement of
a van Emde Boas tree is O.u/, and it is straightforward to create an empty tree
in O.u/ time. In contrast, we can create an empty red-black tree in constant time.
Therefore, we might not want to use a van Emde Boas tree when we perform only
a small number of operations, since the time to create the data structure would
exceed the time saved in the individual operations. This drawback is usually not
signiﬁcant, since we typically use a simple data structure, such as an array or linked
list, to represent a set with only a few elements.

20.3.2   Operations on a van Emde Boas tree
We are now ready to see how to perform operations on a van Emde Boas tree. As
we did for the proto van Emde Boas structure, we will consider the querying oper-
ations ﬁrst, and then I NSERT and D ELETE. Due to the slight asymmetry between
the minimum and maximum elements in a vEB tree—when a vEB tree contains
at least two elements, the minumum element does not appear within a cluster but
the maximum element does—we will provide pseudocode for all ﬁve querying op-
erations. As in the operations on proto van Emde Boas structures, the operations
here that take parameters V and x, where V is a van Emde Boas tree and x is an
element, assume that 0  x < V:u.

Finding the minimum and maximum elements
Because we store the minimum and maximum in the attributes min and max, two
of the operations are one-liners, taking constant time:
