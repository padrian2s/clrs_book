90   Chapter 4 Divide-and-Conquer


        Because subproblem sizes decrease by a factor of 4 each time we go down one
     level, we eventually must reach a boundary condition. How far from the root do
     we reach one? The subproblem size for a node at depth i is n=4i . Thus, the
     subproblem size hits n D 1 when n=4i D 1 or, equivalently, when i D log4 n.
     Thus, the tree has log4 n C 1 levels (at depths 0; 1; 2; : : : ; log4 n).
        Next we determine the cost at each level of the tree. Each level has three times
     more nodes than the level above, and so the number of nodes at depth i is 3i .
     Because subproblem sizes reduce by a factor of 4 for each level we go down
     from the root, each node at depth i, for i D 0; 1; 2; : : : ; log4 n  1, has a cost
     of c.n=4i /2 . Multiplying, we see that the total cost over all nodes at depth i, for
     i D 0; 1; 2; : : : ; log4 n  1, is 3i c.n=4i /2 D .3=16/i cn2 . The bottom level, at
     depth log4 n, has 3log4 n D nlog4 3 nodes, each contributing cost T .1/, for a total
     cost of nlog4 3 T .1/, which is ‚.nlog4 3 /, since we assume that T .1/ is a constant.
        Now we add up the costs over all levels to determine the cost for the entire tree:
                                       2                   log4 n1
                       2     3    2      3        2            3
     T .n/ D cn C               cn C           cn C    C                cn2 C ‚.nlog4 3 /
                            16          16                    16
                  log4 n1 
                     X           
                               3 i 2
             D                      cn C ‚.nlog4 3 /
                     i D0
                              16
                 .3=16/log 4 n  1 2
            D                     cn C ‚.nlog4 3 /       (by equation (A.5)) :
                   .3=16/  1
     This last formula looks somewhat messy until we realize that we can again take
     advantage of small amounts of sloppiness and use an inﬁnite decreasing geometric
     series as an upper bound. Backing up one step and applying equation (A.6), we
     have
                 log4 n1 
                    X           
                              3 i 2
     T .n/ D                      cn C ‚.nlog4 3 /
                     i D0
                             16
                 X  3 i
                    1
             <                  cn2 C ‚.nlog4 3 /
                  i D0
                          16
                   1
            D            cn2 C ‚.nlog4 3 /
              1  .3=16/
              16 2
            D    cn C ‚.nlog4 3 /
              13
            D O.n2 / :
     Thus, we have derived a guess of T .n/ D O.n2 / for our original recurrence
     T .n/ D 3T .bn=4c/ C ‚.n2 /. In this example, the coefﬁcients of cn2 form a
     decreasing geometric series and, by equation (A.6), the sum of these coefﬁcients
