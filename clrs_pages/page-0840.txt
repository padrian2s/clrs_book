28.1 Solving systems of linear equations                                         819

5     6    3
                      x   8 
                            1
   0 0:8 0:6              x2   D      1:4   ;
   0   0  2:5              x3          1:5

      1:4 
thereby obtaining the desired answer


xD        2:2
          0:6
by computing ﬁrst x3 , then x2 , and ﬁnally x1 .

Computing an LU decomposition
We have now shown that if we can create an LUP decomposition for a nonsingular
matrix A, then forward and back substitution can solve the system Ax D b of
linear equations. Now we show how to efﬁciently compute an LUP decomposition
for A. We start with the case in which A is an n n nonsingular matrix and P is
absent (or, equivalently, P D In ). In this case, we factor A D LU . We call the
two matrices L and U an LU decomposition of A.
   We use a process known as Gaussian elimination to create an LU decomposi-
tion. We start by subtracting multiples of the ﬁrst equation from the other equations
in order to remove the ﬁrst variable from those equations. Then, we subtract mul-
tiples of the second equation from the third and subsequent equations so that now
the ﬁrst and second variables are removed from them. We continue this process
until the system that remains has an upper-triangular form—in fact, it is the ma-
trix U . The matrix L is made up of the row multipliers that cause variables to be
eliminated.
   Our algorithm to implement this strategy is recursive. We wish to construct an
LU decomposition for an n n nonsingular matrix A. If n D 1, then we are done,

         ˙a                            
since we can choose L D I1 and U D A. For n > 1, we break A into four parts:

                11   a12      a1n
             a21     a22      a2n
A D           ::      ::   ::     ::
               :       :       :   :
             an1 an2          ann
                    
             a11 w T
     D                 ;
               A0
where  is a column .n  1/-vector, w T is a row .n  1/-vector, and A0 is an
.n  1/ .n  1/ matrix. Then, using matrix algebra (verify the equations by
