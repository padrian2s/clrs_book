608   Chapter 22 Elementary Graph Algorithms


      Proof We begin with the case in which u:d < :d. We consider two subcases,
      according to whether :d < u:f or not. The ﬁrst subcase occurs when :d < u:f ,
      so  was discovered while u was still gray, which implies that  is a descendant
      of u. Moreover, since  was discovered more recently than u, all of its outgo-
      ing edges are explored, and  is ﬁnished, before the search returns to and ﬁn-
      ishes u. In this case, therefore, the interval Œ:d; :f  is entirely contained within
      the interval Œu:d; u:f . In the other subcase, u:f < :d, and by inequality (22.2),
      u:d < u:f < :d < :f ; thus the intervals Œu:d; u:f  and Œ:d; :f  are disjoint.
      Because the intervals are disjoint, neither vertex was discovered while the other
      was gray, and so neither vertex is a descendant of the other.
         The case in which :d < u:d is similar, with the roles of u and  reversed in the
      above argument.

      Corollary 22.8 (Nesting of descendants’ intervals)
      Vertex  is a proper descendant of vertex u in the depth-ﬁrst forest for a (directed
      or undirected) graph G if and only if u:d < :d < :f < u:f .

      Proof   Immediate from Theorem 22.7.

         The next theorem gives another important characterization of when one vertex
      is a descendant of another in the depth-ﬁrst forest.

      Theorem 22.9 (White-path theorem)
      In a depth-ﬁrst forest of a (directed or undirected) graph G D .V; E/, vertex  is
      a descendant of vertex u if and only if at the time u:d that the search discovers u,
      there is a path from u to  consisting entirely of white vertices.

      Proof ): If  D u, then the path from u to  contains just vertex u, which is still
      white when we set the value of u:d. Now, suppose that  is a proper descendant
      of u in the depth-ﬁrst forest. By Corollary 22.8, u:d < :d, and so  is white at
      time u:d. Since  can be any descendant of u, all vertices on the unique simple
      path from u to  in the depth-ﬁrst forest are white at time u:d.
         (: Suppose that there is a path of white vertices from u to  at time u:d, but 
      does not become a descendant of u in the depth-ﬁrst tree. Without loss of general-
      ity, assume that every vertex other than  along the path becomes a descendant of u.
      (Otherwise, let  be the closest vertex to u along the path that doesn’t become a de-
      scendant of u.) Let w be the predecessor of  in the path, so that w is a descendant
      of u (w and u may in fact be the same vertex). By Corollary 22.8, w:f  u:f . Be-
      cause  must be discovered after u is discovered, but before w is ﬁnished, we have
      u:d < :d < w:f  u:f . Theorem 22.7 then implies that the interval Œ:d; :f 
