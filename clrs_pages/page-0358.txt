           Notes for Chapter 13                                                            337


             For nodes x and y in treap T , where y ¤ x, let k D x:key and i D y:key. We
           deﬁne indicator random variables
           Xi k D I fy is in the right spine of the left subtree of xg :

           f. Show that Xi k D 1 if and only if y:priority > x:priority, y:key < x:key, and,
              for every ´ such that y:key < ´:key < x:key, we have y:priority < ´:priority.

           g. Show that
                                        .k  i  1/Š
                Pr fXi k D 1g D
                                        .k  i C 1/Š
                                                1
                                  D                        :
                                        .k  i C 1/.k  i/

           h. Show that
                            X
                            k1
                                     1
                E ŒC  D
                            j D1
                                 j.j C 1/
                                  1
                       D 1         :
                                  k
           i. Use a symmetry argument to show that

                                1
                E ŒD D 1          :
                              nkC1
           j. Conclude that the expected number of rotations performed when inserting a
              node into a treap is less than 2.


Chapter notes

           The idea of balancing a search tree is due to Adel’son-Vel’skiı̆ and Landis [2], who
           introduced a class of balanced search trees called “AVL trees” in 1962, described in
           Problem 13-3. Another class of search trees, called “2-3 trees,” was introduced by
           J. E. Hopcroft (unpublished) in 1970. A 2-3 tree maintains balance by manipulating
           the degrees of nodes in the tree. Chapter 18 covers a generalization of 2-3 trees
           introduced by Bayer and McCreight [35], called “B-trees.”
              Red-black trees were invented by Bayer [34] under the name “symmetric binary
           B-trees.” Guibas and Sedgewick [155] studied their properties at length and in-
           troduced the red/black color convention. Andersson [15] gives a simpler-to-code
