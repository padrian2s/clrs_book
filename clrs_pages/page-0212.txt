8          Sorting in Linear Time




           We have now introduced several algorithms that can sort n numbers in O.n lg n/
           time. Merge sort and heapsort achieve this upper bound in the worst case; quicksort
           achieves it on average. Moreover, for each of these algorithms, we can produce a
           sequence of n input numbers that causes the algorithm to run in .n lg n/ time.
              These algorithms share an interesting property: the sorted order they determine
           is based only on comparisons between the input elements. We call such sorting
           algorithms comparison sorts. All the sorting algorithms introduced thus far are
           comparison sorts.
              In Section 8.1, we shall prove that any comparison sort must make .n lg n/
           comparisons in the worst case to sort n elements. Thus, merge sort and heapsort
           are asymptotically optimal, and no comparison sort exists that is faster by more
           than a constant factor.
              Sections 8.2, 8.3, and 8.4 examine three sorting algorithms—counting sort, radix
           sort, and bucket sort—that run in linear time. Of course, these algorithms use
           operations other than comparisons to determine the sorted order. Consequently,
           the .n lg n/ lower bound does not apply to them.


8.1 Lower bounds for sorting

           In a comparison sort, we use only comparisons between elements to gain order
           information about an input sequence ha1 ; a2 ; : : : ; an i. That is, given two elements
           ai and aj , we perform one of the tests ai < aj , ai  aj , ai D aj , ai  aj , or
           ai > aj to determine their relative order. We may not inspect the values of the
           elements or gain order information about them in any other way.
              In this section, we assume without loss of generality that all the input elements
           are distinct. Given this assumption, comparisons of the form ai D aj are useless,
           so we can assume that no comparisons of this form are made. We also note that
           the comparisons ai  aj , ai  aj , ai > aj , and ai < aj are all equivalent in that
