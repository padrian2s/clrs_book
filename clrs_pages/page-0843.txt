822   Chapter 28 Matrix Operations


      2 3 1 5                2 3 1 5                2   3 1 5               2   3 1    5
      6 13 5 19              3 4 2 4                3   4 2 4               3   4 2    4
      2 19 10 23             1 16 9 18              1   4 1 2               1   4 1    2
      4 10 11 31             2 4 9 21               2   1 7 17              2   1 7    3
         (a)                    (b)                      (c)                     (d)
      2 3    1 5
                         ˘        1 0 0 0˘ 2 3 1 5˘
        6 13 5 19                    3 1 0 0              0 4 2 4
                              D
        2 19 10 23                   1 4 1 0              0 0 1 2
        4 10 11 31                   2 1 7 1              0 0 0 3
               A                          L                    U
                                        (e)


      Figure 28.1 The operation of LU-D ECOMPOSITION. (a) The matrix A. (b) The element a11 D 2
      in the black circle is the pivot, the shaded column is =a11 , and the shaded row is w T . The elements
      of U computed thus far are above the horizontal line, and the elements of L are to the left of the
      vertical line. The Schur complement matrix A0  w T =a11 occupies the lower right. (c) We now
      operate on the Schur complement matrix produced from part (b). The element a22 D 4 in the black
      circle is the pivot, and the shaded column and row are =a22 and w T (in the partitioning of the Schur
      complement), respectively. Lines divide the matrix into the elements of U computed so far (above),
      the elements of L computed so far (left), and the new Schur complement (lower right). (d) After the
      next step, the matrix A is factored. (The element 3 in the new Schur complement becomes part of U
      when the recursion terminates.) (e) The factorization A D LU .


      trix A. (We don’t need to divide by akk in line 12 because we already did so when
      we computed li k in line 8.) Because line 12 is triply nested, LU-D ECOMPOSITION
      runs in time ‚.n3 /.
         Figure 28.1 illustrates the operation of LU-D ECOMPOSITION. It shows a stan-
      dard optimization of the procedure in which we store the signiﬁcant elements of L
      and U in place in the matrix A. That is, we can set up a correspondence between
      each element aij and either lij (if i > j ) or uij (if i  j ) and update the ma-
      trix A so that it holds both L and U when the procedure terminates. To obtain
      the pseudocode for this optimization from the above pseudocode, just replace each
      reference to l or u by a; you can easily verify that this transformation preserves
      correctness.

      Computing an LUP decomposition
      Generally, in solving a system of linear equations Ax D b, we must pivot on off-
      diagonal elements of A to avoid dividing by 0. Dividing by 0 would, of course,
      be disastrous. But we also want to avoid dividing by a small value—even if A is
