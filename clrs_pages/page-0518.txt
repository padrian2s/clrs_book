18.2 Basic operations on B-trees                                                   497


correct one to descend to. (Note that there is no need for a D ISK -R EAD .x:ci / after
line 16 increments i, since the recursion will descend in this case to a child that
was just created by B-T REE -S PLIT-C HILD.) The net effect of lines 13–16 is thus
to guarantee that the procedure never recurses to a full node. Line 17 then recurses
to insert k into the appropriate subtree. Figure 18.7 illustrates the various cases of
inserting into a B-tree.
   For a B-tree of height h, B-T REE -I NSERT performs O.h/ disk accesses, since
only O.1/ D ISK -R EAD and D ISK -W RITE operations occur between calls to
B-T REE -I NSERT-N ONFULL . The total CPU time used is O.th/ D O.t log t n/.
Since B-T REE -I NSERT-N ONFULL is tail-recursive, we can alternatively imple-
ment it as a while loop, thereby demonstrating that the number of pages that need
to be in main memory at any time is O.1/.

Exercises

18.2-1
Show the results of inserting the keys
F; S; Q; K; C; L; H; T; V; W; M; R; N; P; A; B; X; Y; D; Z; E
in order into an empty B-tree with minimum degree 2. Draw only the conﬁgura-
tions of the tree just before some node must split, and also draw the ﬁnal conﬁgu-
ration.

18.2-2
Explain under what circumstances, if any, redundant D ISK -R EAD or D ISK -W RITE
operations occur during the course of executing a call to B-T REE -I NSERT. (A
redundant D ISK -R EAD is a D ISK -R EAD for a page that is already in memory.
A redundant D ISK -W RITE writes to disk a page of information that is identical to
what is already stored there.)

18.2-3
Explain how to ﬁnd the minimum key stored in a B-tree and how to ﬁnd the prede-
cessor of a given key stored in a B-tree.

18.2-4 ?
Suppose that we insert the keys f1; 2; : : : ; ng into an empty B-tree with minimum
degree 2. How many nodes does the ﬁnal B-tree have?

18.2-5
Since leaf nodes require no pointers to children, they could conceivably use a dif-
ferent (larger) t value than internal nodes for the same disk page size. Show how
to modify the procedures for creating and inserting into a B-tree to handle this
variation.
