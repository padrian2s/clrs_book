934   Chapter 31 Number-Theoretic Algorithms


         In principle, we can compute gcd.a; b/ for positive integers a and b from the
      prime factorizations of a and b. Indeed, if
      a D p1e1 p2e2    prer ;                                                    (31.11)
      b D p1f1 p2f2    prfr ;                                                    (31.12)
      with zero exponents being used to make the set of primes p1 ; p2 ; : : : ; pr the same
      for both a and b, then, as Exercise 31.2-1 asks you to show,

      gcd.a; b/ D p1min.e1 ;f1 / p2min.e2 ;f2 /    prmin.er ;fr / :              (31.13)
      As we shall show in Section 31.9, however, the best algorithms to date for factoring
      do not run in polynomial time. Thus, this approach to computing greatest common
      divisors seems unlikely to yield an efﬁcient algorithm.
         Euclid’s algorithm for computing greatest common divisors relies on the follow-
      ing theorem.

      Theorem 31.9 (GCD recursion theorem)
      For any nonnegative integer a and any positive integer b,
      gcd.a; b/ D gcd.b; a mod b/ :

      Proof We shall show that gcd.a; b/ and gcd.b; a mod b/ divide each other, so
      that by equation (31.5) they must be equal (since they are both nonnegative).
         We ﬁrst show that gcd.a; b/ j gcd.b; a mod b/. If we let d D gcd.a; b/, then
      d j a and d j b. By equation (3.8), a mod b D a  qb, where q D ba=bc.
      Since a mod b is thus a linear combination of a and b, equation (31.4) implies that
      d j .a mod b/. Therefore, since d j b and d j .a mod b/, Corollary 31.3 implies
      that d j gcd.b; a mod b/ or, equivalently, that
      gcd.a; b/ j gcd.b; a mod b/:                                                  (31.14)
        Showing that gcd.b; a mod b/ j gcd.a; b/ is almost the same. If we now let
      d D gcd.b; a mod b/, then d j b and d j .a mod b/. Since a D qb C .a mod b/,
      where q D ba=bc, we have that a is a linear combination of b and .a mod b/. By
      equation (31.4), we conclude that d j a. Since d j b and d j a, we have that
      d j gcd.a; b/ by Corollary 31.3 or, equivalently, that
      gcd.b; a mod b/ j gcd.a; b/:                                                  (31.15)
      Using equation (31.5) to combine equations (31.14) and (31.15) completes the
      proof.
