738   Chapter 26 Maximum Flow


      the ﬁxed height jV j of the source. As we shall see, once we have emptied all the
      reservoirs, the preﬂow is not only a “legal” ﬂow, it is also a maximum ﬂow.

      The basic operations
      From the preceding discussion, we see that a push-relabel algorithm performs two
      basic operations: pushing ﬂow excess from a vertex to one of its neighbors and
      relabeling a vertex. The situations in which these operations apply depend on the
      heights of vertices, which we now deﬁne precisely.
         Let G D .V; E/ be a ﬂow network with source s and sink t, and let f be a
      preﬂow in G. A function h W V ! N is a height function3 if h.s/ D jV j,
      h.t/ D 0, and
      h.u/  h./ C 1
      for every residual edge .u; / 2 Ef . We immediately obtain the following lemma.

      Lemma 26.12
      Let G D .V; E/ be a ﬂow network, let f be a preﬂow in G, and let h be a height
      function on V . For any two vertices u;  2 V , if h.u/ > h./ C 1, then .u; / is
      not an edge in the residual network.

      The push operation
      The basic operation P USH .u; / applies if u is an overﬂowing vertex, cf .u; / > 0,
      and h.u/ D h./ C1. The pseudocode below updates the preﬂow f and the excess
      ﬂows for u and . It assumes that we can compute residual capacity cf .u; / in
      constant time given c and f . We maintain the excess ﬂow stored at a vertex u as
      the attribute u:e and the height of u as the attribute u:h. The expression f .u; /
      is a temporary variable that stores the amount of ﬂow that we can push from u to .


      3 In the literature, a height function is typically called a “distance function,” and the height of a vertex

      is called a “distance label.” We use the term “height” because it is more suggestive of the intuition
      behind the algorithm. We retain the use of the term “relabel” to refer to the operation that increases
      the height of a vertex. The height of a vertex is related to its distance from the sink t, as would be
      found in a breadth-ﬁrst search of the transpose G T .
