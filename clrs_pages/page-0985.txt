964   Chapter 31 Number-Theoretic Algorithms


      long—to resist possible advances in the art of factoring. At the time of this
      writing (2009), RSA moduli were commonly in the range of 768 to 2048 bits.
      To create moduli of such sizes, we must be able to ﬁnd large primes efﬁciently.
      Section 31.8 addresses this problem.
         For efﬁciency, RSA is often used in a “hybrid” or “key-management” mode
      with fast non-public-key cryptosystems. With such a system, the encryption and
      decryption keys are identical. If Alice wishes to send a long message M to Bob
      privately, she selects a random key K for the fast non-public-key cryptosystem and
      encrypts M using K, obtaining ciphertext C . Here, C is as long as M , but K
      is quite short. Then, she encrypts K using Bob’s public RSA key. Since K is
      short, computing PB .K/ is fast (much faster than computing PB .M /). She then
      transmits .C; PB .K// to Bob, who decrypts PB .K/ to obtain K and then uses K
      to decrypt C , obtaining M .
         We can use a similar hybrid approach to make digital signatures efﬁciently.
      This approach combines RSA with a public collision-resistant hash function h—a
      function that is easy to compute but for which it is computationally infeasible to
      ﬁnd two messages M and M 0 such that h.M / D h.M 0 /. The value h.M / is
      a short (say, 256-bit) “ﬁngerprint” of the message M . If Alice wishes to sign a
      message M , she ﬁrst applies h to M to obtain the ﬁngerprint h.M /, which she
      then encrypts with her secret key. She sends .M; SA .h.M /// to Bob as her signed
      version of M . Bob can verify the signature by computing h.M / and verifying
      that PA applied to SA .h.M // as received equals h.M /. Because no one can create
      two messages with the same ﬁngerprint, it is computationally infeasible to alter a
      signed message and preserve the validity of the signature.
         Finally, we note that the use of certiﬁcates makes distributing public keys much
      easier. For example, assume there is a “trusted authority” T whose public key
      is known by everyone. Alice can obtain from T a signed message (her certiﬁcate)
      stating that “Alice’s public key is PA .” This certiﬁcate is “self-authenticating” since
      everyone knows PT . Alice can include her certiﬁcate with her signed messages,
      so that the recipient has Alice’s public key immediately available in order to verify
      her signature. Because her key was signed by T , the recipient knows that Alice’s
      key is really Alice’s.

      Exercises

      31.7-1
      Consider an RSA key set with p D 11, q D 29, n D 319, and e D 3. What
      value of d should be used in the secret key? What is the encryption of the message
      M D 100?
