31.2 Greatest common divisor                                                                          937



a     b     ba=bc     d      x       y
99    78      1       3     11      14
78    21      3       3      3      11
21    15      1       3     2        3
15     6      2       3      1      2
6      3      2       3      0        1
3      0      —       3      1        0


Figure 31.1 How E XTENDED -E UCLID computes gcd.99; 78/. Each line shows one level of the
recursion: the values of the inputs a and b, the computed value ba=bc, and the values d , x, and y
returned. The triple .d; x; y/ returned becomes the triple .d 0 ; x 0 ; y 0 / used at the next higher level
of recursion. The call E XTENDED -E UCLID.99; 78/ returns .3; 11; 14/, so that gcd.99; 78/ D 3 D
99  .11/ C 78  14.


Exercise 31.2-5 for a tighter bound.) Therefore, if we call E UCLID on two ˇ-bit
numbers, then it performs O.ˇ/ arithmetic operations and O.ˇ 3 / bit operations
(assuming that multiplication and division of ˇ-bit numbers take O.ˇ 2 / bit oper-
ations). Problem 31-2 asks you to show an O.ˇ 2 / bound on the number of bit
operations.

The extended form of Euclid’s algorithm
We now rewrite Euclid’s algorithm to compute additional useful information.
Speciﬁcally, we extend the algorithm to compute the integer coefﬁcients x and y
such that
d D gcd.a; b/ D ax C by :                                                                        (31.16)
Note that x and y may be zero or negative. We shall ﬁnd these coefﬁcients useful
later for computing modular multiplicative inverses. The procedure E XTENDED -
E UCLID takes as input a pair of nonnegative integers and returns a triple of the
form .d; x; y/ that satisﬁes equation (31.16).

E XTENDED -E UCLID .a; b/
1 if b == 0
2      return .a; 1; 0/
3 else .d 0 ; x 0 ; y 0 / D E XTENDED -E UCLID .b; a mod b/
4      .d; x; y/ D .d 0 ; y 0 ; x 0  ba=bc y 0 /
5      return .d; x; y/

Figure 31.1 illustrates how E XTENDED -E UCLID computes gcd.99; 78/.
  The E XTENDED -E UCLID procedure is a variation of the E UCLID procedure.
Line 1 is equivalent to the test “b == 0” in line 1 of E UCLID. If b D 0, then
