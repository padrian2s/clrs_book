                 25.3 Johnson’s algorithm for sparse graphs                                                         703



                0                                                                     5
                                2                                                                    2
                0              –1                                                     1             –1
                      3                4                                                    4             0
                1                                                                     1
        0       0                                –5 3                             0   0                         –5 3
0                     2                8                               0                    2             13

                –4                           –5                                        0                        0
        0              7              1                                           4         10            0

                      –4               0 4                                                  –4            0 4
                                6                                                                   2
                0     5                                                               0     5

                      (a)                                                                    (b)

                2                                           2                                        2
               2/1                                         0/0                                      0/4
       4                   0                       4             0                          4             0
 1                               3          1                                3         1                         3
0/0                            2/–3        2/3                             0/–4       2/7                       0/0
       2                13                             2         13                             2         13

 0                             0            0                              0           0                        0
       10              0                           10            0                          10            0

      0/–4             2/2                        2/–1           0/1                        2/3           0/5
                2                                           2                                        2
       5                  4                        5              4                          5             4
               (c)                                         (d)                                      (e)

                 2                                          2
               0/–1                                        2/5
       4                   0                       4             0
 1                               3          1                               3
2/2                            0/–5        4/8                             2/1
           2              13                           2         13

 0                             0            0                              0
       10              0                           10            0

      2/–2             0/0                        0/0            2/6
                2                                          2
       5                   4                       5              4
               (f)                                         (g)


                 Figure 25.6 Johnson’s all-pairs shortest-paths algorithm run on the graph of Figure 25.1. Ver-
                 tex numbers appear outside the vertices. (a) The graph G 0 with the original weight function w.
                 The new vertex s is black. Within each vertex  is h./ D ı.s; /. (b) After reweighting each
                 edge .u; / with weight function yw.u; / D w.u; / C h.u/  h./. (c)–(g) The result of running
                 Dijkstra’s algorithm on each vertex of G using weight function wy. In each part, the source vertex u
                 is black, and shaded edges are in the shortest-paths tree computed by the algorithm. Within each
                                         y / and ı.u; /, separated by a slash. The value du D ı.u; / is equal to
                 vertex  are the values ı.u;
                 y
                 ı.u; / C h./  h.u/.
