      22.4 Topological sort                                                                                613


        11/16    undershorts                         socks 17/18
                                                                    watch 9/10
           12/15      pants                          shoes 13/14
                                      shirt 1/8
(a)             6/7   belt
                                       tie    2/5


                                      jacket 3/4




(b)      socks          undershorts          pants   shoes     watch       shirt    belt      tie      jacket
         17/18                11/16          12/15    13/14        9/10     1/8     6/7       2/5        3/4



      Figure 22.7 (a) Professor Bumstead topologically sorts his clothing when getting dressed. Each
      directed edge .u; / means that garment u must be put on before garment . The discovery and
      ﬁnishing times from a depth-ﬁrst search are shown next to each vertex. (b) The same graph shown
      topologically sorted, with its vertices arranged from left to right in order of decreasing ﬁnishing time.
      All directed edges go from left to right.


      pants). A directed edge .u; / in the dag of Figure 22.7(a) indicates that garment u
      must be donned before garment . A topological sort of this dag therefore gives an
      order for getting dressed. Figure 22.7(b) shows the topologically sorted dag as an
      ordering of vertices along a horizontal line such that all directed edges go from left
      to right.
         The following simple algorithm topologically sorts a dag:

      T OPOLOGICAL -S ORT .G/
      1 call DFS.G/ to compute ﬁnishing times :f for each vertex 
      2 as each vertex is ﬁnished, insert it onto the front of a linked list
      3 return the linked list of vertices

      Figure 22.7(b) shows how the topologically sorted vertices appear in reverse order
      of their ﬁnishing times.
         We can perform a topological sort in time ‚.V C E/, since depth-ﬁrst search
      takes ‚.V C E/ time and it takes O.1/ time to insert each of the jV j vertices onto
      the front of the linked list.
         We prove the correctness of this algorithm using the following key lemma char-
      acterizing directed acyclic graphs.
