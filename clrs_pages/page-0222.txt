8.4 Bucket sort                                                                                   201


    A             B
1  .78        0
2 .17         1         .12           .17
3 .39         2         .21           .23      .26
4 .26         3         .39
5 .72         4
6 .94         5
7 .21         6         .68
8 .12         7         .72           .78
9 .23         8
10 .68        9         .94
    (a)                         (b)


Figure 8.4 The operation of B UCKET-S ORT for n D 10. (a) The input array AŒ1 : : 10. (b) The
array BŒ0 : : 9 of sorted lists (buckets) after line 8 of the algorithm. Bucket i holds values in the
half-open interval Œi=10; .i C 1/=10/. The sorted output consists of a concatenation in order of the
lists BŒ0; BŒ1; : : : ; BŒ9.


B UCKET-S ORT .A/
1 let BŒ0 : : n  1 be a new array
2 n D A:length
3 for i D 0 to n  1
4      make BŒi an empty list
5 for i D 1 to n
6      insert AŒi into list BŒbnAŒic
7 for i D 0 to n  1
8      sort list BŒi with insertion sort
9 concatenate the lists BŒ0; BŒ1; : : : ; BŒn  1 together in order

Figure 8.4 shows the operation of bucket sort on an input array of 10 numbers.
   To see that this algorithm works, consider two elements AŒi and AŒj . Assume
without loss of generality that AŒi  AŒj . Since bnAŒic  bnAŒj c, either
element AŒi goes into the same bucket as AŒj  or it goes into a bucket with a lower
index. If AŒi and AŒj  go into the same bucket, then the for loop of lines 7–8 puts
them into the proper order. If AŒi and AŒj  go into different buckets, then line 9
puts them into the proper order. Therefore, bucket sort works correctly.
   To analyze the running time, observe that all lines except line 8 take O.n/ time
in the worst case. We need to analyze the total time taken by the n calls to insertion
sort in line 8.
