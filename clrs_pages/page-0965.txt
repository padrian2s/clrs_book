944   Chapter 31 Number-Theoretic Algorithms


      Theorem 31.14 (A nonempty closed subset of a ﬁnite group is a subgroup)
      If .S; ˚/ is a ﬁnite group and S 0 is any nonempty subset of S such that a ˚ b 2 S 0
      for all a; b 2 S 0 , then .S 0 ; ˚/ is a subgroup of .S; ˚/.

      Proof     We leave the proof as Exercise 31.3-3.

        For example, the set f0; 2; 4; 6g forms a subgroup of Z8 , since it is nonempty
      and closed under the operation C (that is, it is closed under C8 ).
        The following theorem provides an extremely useful constraint on the size of a
      subgroup; we omit the proof.

      Theorem 31.15 (Lagrange’s theorem)
      If .S; ˚/ is a ﬁnite group and .S 0 ; ˚/ is a subgroup of .S; ˚/, then jS 0 j is a divisor
      of jSj.

         A subgroup S 0 of a group S is a proper subgroup if S 0 ¤ S. We shall use the
      following corollary in our analysis in Section 31.8 of the Miller-Rabin primality
      test procedure.

      Corollary 31.16
      If S 0 is a proper subgroup of a ﬁnite group S, then jS 0 j  jSj =2.


      Subgroups generated by an element
      Theorem 31.14 gives us an easy way to produce a subgroup of a ﬁnite group .S; ˚/:
      choose an element a and take all elements that can be generated from a using the
      group operation. Speciﬁcally, deﬁne a.k/ for k  1 by
               M
               k
      a.k/ D
               i D1
                           œ
                      a D a ˚ a ˚  ˚ a :
                                      k

      For example, if we take a D 2 in the group Z6 , the sequence a.1/ ; a.2/ ; a.3/ ; : : : is
      2; 4; 0; 2; 4; 0; 2; 4; 0; : : : :
      In the group Zn , we have a.k/ D ka mod n, and in the group Zn , we have a.k/ D
      ak mod n. We deﬁne the subgroup generated by a, denoted hai or .hai; ˚/, by
      hai D fa.k/ W k  1g :
      We say that a generates the subgroup hai or that a is a generator of hai. Since S is
      ﬁnite, hai is a ﬁnite subset of S, possibly including all of S. Since the associativity
      of ˚ implies
