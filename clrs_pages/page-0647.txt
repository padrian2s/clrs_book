626   Chapter 23 Minimum Spanning Trees


      tree. We call such an edge a safe edge for A, since we can add it safely to A while
      maintaining the invariant.

      G ENERIC -MST.G; w/
      1 AD;
      2 while A does not form a spanning tree
      3      ﬁnd an edge .u; / that is safe for A
      4      A D A [ f.u; /g
      5 return A

      We use the loop invariant as follows:
      Initialization: After line 1, the set A trivially satisﬁes the loop invariant.
      Maintenance: The loop in lines 2–4 maintains the invariant by adding only safe
        edges.
      Termination: All edges added to A are in a minimum spanning tree, and so the
         set A returned in line 5 must be a minimum spanning tree.
         The tricky part is, of course, ﬁnding a safe edge in line 3. One must exist, since
      when line 3 is executed, the invariant dictates that there is a spanning tree T such
      that A  T . Within the while loop body, A must be a proper subset of T , and
      therefore there must be an edge .u; / 2 T such that .u; / 62 A and .u; / is safe
      for A.
         In the remainder of this section, we provide a rule (Theorem 23.1) for recogniz-
      ing safe edges. The next section describes two algorithms that use this rule to ﬁnd
      safe edges efﬁciently.
         We ﬁrst need some deﬁnitions. A cut .S; V  S/ of an undirected graph G D
      .V; E/ is a partition of V . Figure 23.2 illustrates this notion. We say that an edge
      .u; / 2 E crosses the cut .S; V  S/ if one of its endpoints is in S and the other
      is in V  S. We say that a cut respects a set A of edges if no edge in A crosses the
      cut. An edge is a light edge crossing a cut if its weight is the minimum of any edge
      crossing the cut. Note that there can be more than one light edge crossing a cut in
      the case of ties. More generally, we say that an edge is a light edge satisfying a
      given property if its weight is the minimum of any edge satisfying the property.
         Our rule for recognizing safe edges is given by the following theorem.

      Theorem 23.1
      Let G D .V; E/ be a connected, undirected graph with a real-valued weight func-
      tion w deﬁned on E. Let A be a subset of E that is included in some minimum
      spanning tree for G, let .S; V  S/ be any cut of G that respects A, and let .u; /
      be a light edge crossing .S; V  S/. Then, edge .u; / is safe for A.
