Chapter 24   Single-Source Shortest Paths                                           647


contains at most jV j distinct vertices, it also contains at most jV j  1 edges. Thus,
we can restrict our attention to shortest paths of at most jV j  1 edges.

Representing shortest paths
We often wish to compute not only shortest-path weights, but the vertices on short-
est paths as well. We represent shortest paths similarly to how we represented
breadth-ﬁrst trees in Section 22.2. Given a graph G D .V; E/, we maintain for
each vertex  2 V a predecessor : that is either another vertex or NIL. The
shortest-paths algorithms in this chapter set the  attributes so that the chain of pre-
decessors originating at a vertex  runs backwards along a shortest path from s to .
Thus, given a vertex  for which : ¤ NIL , the procedure P RINT-PATH .G; s; /
from Section 22.2 will print a shortest path from s to .
   In the midst of executing a shortest-paths algorithm, however, the  values might
not indicate shortest paths. As in breadth-ﬁrst search, we shall be interested in the
predecessor subgraph G D .V ; E / induced by the  values. Here again, we
deﬁne the vertex set V to be the set of vertices of G with non-NIL predecessors,
plus the source s:
V D f 2 V W : ¤ NIL g [ fsg :
The directed edge set E is the set of edges induced by the  values for vertices
in V :
E D f.:; / 2 E W  2 V  fsgg :
   We shall prove that the  values produced by the algorithms in this chapter have
the property that at termination G is a “shortest-paths tree”—informally, a rooted
tree containing a shortest path from the source s to every vertex that is reachable
from s. A shortest-paths tree is like the breadth-ﬁrst tree from Section 22.2, but it
contains shortest paths from the source deﬁned in terms of edge weights instead of
numbers of edges. To be precise, let G D .V; E/ be a weighted, directed graph
with weight function w W E ! R, and assume that G contains no negative-weight
cycles reachable from the source vertex s 2 V , so that shortest paths are well
deﬁned. A shortest-paths tree rooted at s is a directed subgraph G 0 D .V 0 ; E 0 /,
where V 0  V and E 0  E, such that
1. V 0 is the set of vertices reachable from s in G,
2. G 0 forms a rooted tree with root s, and
3. for all  2 V 0 , the unique simple path from s to  in G 0 is a shortest path from s
   to  in G.
