938   Chapter 31 Number-Theoretic Algorithms


      E XTENDED -E UCLID returns not only d D a in line 2, but also the coefﬁcients
      x D 1 and y D 0, so that a D ax C by. If b ¤ 0, E XTENDED -E UCLID ﬁrst
      computes .d 0 ; x 0 ; y 0 / such that d 0 D gcd.b; a mod b/ and
      d 0 D bx 0 C .a mod b/y 0 :                                               (31.17)
      As for E UCLID, we have in this case d D gcd.a; b/ D d 0 D gcd.b; a mod b/.
      To obtain x and y such that d D ax C by, we start by rewriting equation (31.17)
      using the equation d D d 0 and equation (3.8):
      d   D bx 0 C .a  b ba=bc/y 0
          D ay 0 C b.x 0  ba=bc y 0 / :
      Thus, choosing x D y 0 and y D x 0  ba=bc y 0 satisﬁes the equation d D ax C by,
      proving the correctness of E XTENDED -E UCLID.
        Since the number of recursive calls made in E UCLID is equal to the number
      of recursive calls made in E XTENDED -E UCLID, the running times of E UCLID
      and E XTENDED -E UCLID are the same, to within a constant factor. That is, for
      a > b > 0, the number of recursive calls is O.lg b/.

      Exercises

      31.2-1
      Prove that equations (31.11) and (31.12) imply equation (31.13).

      31.2-2
      Compute the values .d; x; y/ that the call E XTENDED -E UCLID .899; 493/ returns.

      31.2-3
      Prove that for all integers a, k, and n,
      gcd.a; n/ D gcd.a C k n; n/ :

      31.2-4
      Rewrite E UCLID in an iterative form that uses only a constant amount of memory
      (that is, stores only a constant number of integer values).

      31.2-5
      If a > b  0, show that the call E UCLID .a; b/ makes at most 1 C log b recursive
      calls. Improve this bound to 1 C log .b= gcd.a; b//.

      31.2-6
      What does E XTENDED -E UCLID .FkC1 ; Fk / return? Prove your answer correct.
