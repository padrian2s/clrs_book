952   Chapter 31 Number-Theoretic Algorithms


      ci D mi .m1
                i  mod ni /                                                             (31.31)
      for i D 1; 2; : : : ; k. Equation (31.31) is always well deﬁned: since mi and ni are
      relatively prime (by Theorem 31.6), Corollary 31.26 guarantees that m1         i mod ni
      exists. Finally, we can compute a as a function of a1 , a2 , . . . , ak as follows:
      a  .a1 c1 C a2 c2 C    C ak ck / .mod n/ :                                    (31.32)
         We now show that equation (31.32) ensures that a  ai .mod ni / for i D
      1; 2; : : : ; k. Note that if j ¤ i, then mj  0 .mod ni /, which implies that cj 
      mj  0 .mod ni /. Note also that ci  1 .mod ni /, from equation (31.31). We
      thus have the appealing and useful correspondence
      ci $ .0; 0; : : : ; 0; 1; 0; : : : ; 0/ ;
      a vector that has 0s everywhere except in the ith coordinate, where it has a 1; the ci
      thus form a “basis” for the representation, in a certain sense. For each i, therefore,
      we have
      a  ai ci              .mod ni /
                  1
         ai mi .mi mod ni / .mod ni /
         ai                 .mod ni / ;
      which is what we wished to show: our method of computing a from the ai ’s pro-
      duces a result a that satisﬁes the constraints a  ai .mod ni / for i D 1; 2; : : : ; k.
      The correspondence is one-to-one, since we can transform in both directions.
      Finally, equations (31.28)–(31.30) follow directly from Exercise 31.1-7, since
      x mod ni D .x mod n/ mod ni for any x and i D 1; 2; : : : ; k.

         We shall use the following corollaries later in this chapter.

      Corollary 31.28
      If n1 ; n2 ; : : : ; nk are pairwise relatively prime and n D n1 n2    nk , then for any
      integers a1 ; a2 ; : : : ; ak , the set of simultaneous equations
      x  ai .mod ni / ;
      for i D 1; 2; : : : ; k, has a unique solution modulo n for the unknown x.


      Corollary 31.29
      If n1 ; n2 ; : : : ; nk are pairwise relatively prime and n D n1 n2    nk , then for all
      integers x and a,
      x  a .mod ni /
      for i D 1; 2; : : : ; k if and only if
      x  a .mod n/ :
