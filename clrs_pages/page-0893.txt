872   Chapter 29 Linear Programming


      ity constraints; the basic variable associated with this constraint is xl . Again, we
      are free to choose one of several variables as the leaving variable, but we assume
      that we use some prespeciﬁed deterministic rule. If none of the constraints lim-
      its the amount by which the entering variable can increase, the algorithm returns
      “unbounded” in line 11. Otherwise, line 12 exchanges the roles of the entering
      and leaving variables by calling P IVOT .N; B; A; b; c; ; l; e/, as described above.
      Lines 13–16 compute a solution xN 1 ; xN 2 ; : : : ; xN n for the original linear-programming
      variables by setting all the nonbasic variables to 0 and each basic variable xN i to bi ,
      and line 17 returns these values.
         To show that S IMPLEX is correct, we ﬁrst show that if S IMPLEX has an initial
      feasible solution and eventually terminates, then it either returns a feasible solution
      or determines that the linear program is unbounded. Then, we show that S IMPLEX
      terminates. Finally, in Section 29.4 (Theorem 29.10) we show that the solution
      returned is optimal.

      Lemma 29.2
      Given a linear program .A; b; c/, suppose that the call to I NITIALIZE -S IMPLEX in
      line 1 of S IMPLEX returns a slack form for which the basic solution is feasible.
      Then if S IMPLEX returns a solution in line 17, that solution is a feasible solution to
      the linear program. If S IMPLEX returns “unbounded” in line 11, the linear program
      is unbounded.

      Proof    We use the following three-part loop invariant:
         At the start of each iteration of the while loop of lines 3–12,
         1. the slack form is equivalent to the slack form returned by the call of
            I NITIALIZE -S IMPLEX,
         2. for each i 2 B, we have bi  0, and
         3. the basic solution associated with the slack form is feasible.

      Initialization: The equivalence of the slack forms is trivial for the ﬁrst itera-
         tion. We assume, in the statement of the lemma, that the call to I NITIALIZE -
          S IMPLEX in line 1 of S IMPLEX returns a slack form for which the basic solution
         is feasible. Thus, the third part of the invariant is true. Because the basic so-
         lution is feasible, each basic variable xi is nonnegative. Furthermore, since the
         basic solution sets each basic variable xi to bi , we have that bi  0 for all
         i 2 B. Thus, the second part of the invariant holds.
      Maintenance: We shall show that each iteration of the while loop maintains the
        loop invariant, assuming that the return statement in line 11 does not execute.
        We shall handle the case in which line 11 executes when we discuss termination.
