26.2 The Ford-Fulkerson method                                                      729


which contradicts our assumption that ıf 0 .s; / < ıf .s; /. We conclude that our
assumption that such a vertex  exists is incorrect.

   The next theorem bounds the number of iterations of the Edmonds-Karp algo-
rithm.

Theorem 26.8
If the Edmonds-Karp algorithm is run on a ﬂow network G D .V; E/ with source s
and sink t, then the total number of ﬂow augmentations performed by the algorithm
is O.VE/.

Proof We say that an edge .u; / in a residual network Gf is critical on an aug-
menting path p if the residual capacity of p is the residual capacity of .u; /, that
is, if cf .p/ D cf .u; /. After we have augmented ﬂow along an augmenting path,
any critical edge on the path disappears from the residual network. Moreover, at
least one edge on any augmenting path must be critical. We will show that each of
the jEj edges can become critical at most jV j =2 times.
   Let u and  be vertices in V that are connected by an edge in E. Since augment-
ing paths are shortest paths, when .u; / is critical for the ﬁrst time, we have
ıf .s; / D ıf .s; u/ C 1 :
Once the ﬂow is augmented, the edge .u; / disappears from the residual network.
It cannot reappear later on another augmenting path until after the ﬂow from u to 
is decreased, which occurs only if .; u/ appears on an augmenting path. If f 0 is
the ﬂow in G when this event occurs, then we have
ıf 0 .s; u/ D ıf 0 .s; / C 1 :
Since ıf .s; /  ıf 0 .s; / by Lemma 26.7, we have
ıf 0 .s; u/ D ıf 0 .s; / C 1
             ıf .s; / C 1
            D ıf .s; u/ C 2 :
   Consequently, from the time .u; / becomes critical to the time when it next
becomes critical, the distance of u from the source increases by at least 2. The
distance of u from the source is initially at least 0. The intermediate vertices on a
shortest path from s to u cannot contain s, u, or t (since .u; / on an augmenting
path implies that u ¤ t). Therefore, until u becomes unreachable from the source,
if ever, its distance is at most jV j  2. Thus, after the ﬁrst time that .u; / becomes
critical, it can become critical at most .jV j  2/=2 D jV j =2  1 times more, for a
total of at most jV j =2 times. Since there are O.E/ pairs of vertices that can have an
edge between them in a residual network, the total number of critical edges during
