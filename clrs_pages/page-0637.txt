616   Chapter 22 Elementary Graph Algorithms


                 a               b              c               d
               13/14           11/16           1/10            8/9

      (a)

               12/15            3/4            2/7             5/6
                 e               f              g               h


                  a              b              c               d


      (b)


                  e              f              g               h



                                                       cd

      (c)             abe

                                        fg                      h



      Figure 22.9 (a) A directed graph G. Each shaded region is a strongly connected component of G.
      Each vertex is labeled with its discovery and ﬁnishing times in a depth-ﬁrst search, and tree edges
      are shaded. (b) The graph G T , the transpose of G, with the depth-ﬁrst forest computed in line 3
      of S TRONGLY-C ONNECTED -C OMPONENTS shown and tree edges shaded. Each strongly connected
      component corresponds to one depth-ﬁrst tree. Vertices b, c, g, and h, which are heavily shaded, are
      the roots of the depth-ﬁrst trees produced by the depth-ﬁrst search of G T . (c) The acyclic component
      graph G SCC obtained by contracting all edges within each strongly connected component of G so
      that only a single vertex remains in each component.


         Our algorithm for ﬁnding strongly connected components of a graph G D
      .V; E/ uses the transpose of G, which we deﬁned in Exercise 22.1-3 to be the
      graph G T D .V; E T /, where E T D f.u; / W .; u/ 2 Eg. That is, E T consists of
      the edges of G with their directions reversed. Given an adjacency-list representa-
      tion of G, the time to create G T is O.V C E/. It is interesting to observe that G
      and G T have exactly the same strongly connected components: u and  are reach-
      able from each other in G if and only if they are reachable from each other in G T .
      Figure 22.9(b) shows the transpose of the graph in Figure 22.9(a), with the strongly
      connected components shaded.
