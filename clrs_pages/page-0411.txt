390       Chapter 15 Dynamic Programming


          the number of scalar multiplications. Does this problem exhibit optimal substruc-
          ture?

          15.3-4
          As stated, in dynamic programming we ﬁrst solve the subproblems and then choose
          which of them to use in an optimal solution to the problem. Professor Capulet
          claims that we do not always need to solve all the subproblems in order to ﬁnd an
          optimal solution. She suggests that we can ﬁnd an optimal solution to the matrix-
          chain multiplication problem by always choosing the matrix Ak at which to split
          the subproduct Ai Ai C1    Aj (by selecting k to minimize the quantity pi 1 pk pj )
          before solving the subproblems. Find an instance of the matrix-chain multiplica-
          tion problem for which this greedy approach yields a suboptimal solution.

          15.3-5
          Suppose that in the rod-cutting problem of Section 15.1, we also had limit li on the
          number of pieces of length i that we are allowed to produce, for i D 1; 2; : : : ; n.
          Show that the optimal-substructure property described in Section 15.1 no longer
          holds.

          15.3-6
          Imagine that you wish to exchange one currency for another. You realize that
          instead of directly exchanging one currency for another, you might be better off
          making a series of trades through other currencies, winding up with the currency
          you want. Suppose that you can trade n different currencies, numbered 1; 2; : : : ; n,
          where you start with currency 1 and wish to wind up with currency n. You are
          given, for each pair of currencies i and j , an exchange rate rij , meaning that if
          you start with d units of currency i, you can trade for drij units of currency j .
          A sequence of trades may entail a commission, which depends on the number of
          trades you make. Let ck be the commission that you are charged when you make k
          trades. Show that, if ck D 0 for all k D 1; 2; : : : ; n, then the problem of ﬁnding the
          best sequence of exchanges from currency 1 to currency n exhibits optimal sub-
          structure. Then show that if commissions ck are arbitrary values, then the problem
          of ﬁnding the best sequence of exchanges from currency 1 to currency n does not
          necessarily exhibit optimal substructure.



15.4 Longest common subsequence

          Biological applications often need to compare the DNA of two (or more) dif-
          ferent organisms. A strand of DNA consists of a string of molecules called
