382   Chapter 15 Dynamic Programming


       q          r



       s          t



      Figure 15.6 A directed graph showing that the problem of ﬁnding a longest simple path in an
      unweighted directed graph does not have optimal substructure. The path q ! r ! t is a longest
      simple path from q to t, but the subpath q ! r is not a longest simple path from q to r, nor is the
      subpath r ! t a longest simple path from r to t.


      Unweighted longest simple path: Find a simple path from u to  consisting of
        the most edges. We need to include the requirement of simplicity because other-
        wise we can traverse a cycle as many times as we like to create paths with an
        arbitrarily large number of edges.
         The unweighted shortest-path problem exhibits optimal substructure, as follows.
      Suppose that u ¤ , so that the problem is nontrivial. Then, any path p from u
      to  must contain an intermediate vertex, say w. (Note that w may be u or .)
                                               p                   p    p
      Thus, we can decompose the path u ;  into subpaths u ;1 w ;2 . Clearly, the
      number of edges in p equals the number of edges in p1 plus the number of edges
      in p2 . We claim that if p is an optimal (i.e., shortest) path from u to , then p1
      must be a shortest path from u to w. Why? We use a “cut-and-paste” argument:
      if there were another path, say p10 , from u to w with fewer edges than p1 , then we
                                                                      p0      p
      could cut out p1 and paste in p10 to produce a path u ;1 w ;2  with fewer edges
      than p, thus contradicting p’s optimality. Symmetrically, p2 must be a shortest
      path from w to . Thus, we can ﬁnd a shortest path from u to  by considering
      all intermediate vertices w, ﬁnding a shortest path from u to w and a shortest path
      from w to , and choosing an intermediate vertex w that yields the overall shortest
      path. In Section 25.2, we use a variant of this observation of optimal substructure
      to ﬁnd a shortest path between every pair of vertices on a weighted, directed graph.
         You might be tempted to assume that the problem of ﬁnding an unweighted
      longest simple path exhibits optimal substructure as well. After all, if we decom-
                                      p                      p     p
      pose a longest simple path u ;  into subpaths u ;1 w ;2 , then mustn’t p1
      be a longest simple path from u to w, and mustn’t p2 be a longest simple path
      from w to ? The answer is no! Figure 15.6 supplies an example. Consider the
      path q ! r ! t, which is a longest simple path from q to t. Is q ! r a longest
      simple path from q to r? No, for the path q ! s ! t ! r is a simple path
      that is longer. Is r ! t a longest simple path from r to t? No again, for the path
      r ! q ! s ! t is a simple path that is longer.
