31.9 Integer factorization                                                                     977


x1 ; x2 ; x4 ; x8 ; x16 ; : : : :
Line 3 saves the value x1 , and line 12 saves xk whenever i is equal to k. The
variable k is initialized to 2 in line 4, and line 13 doubles it whenever line 12
updates y. Therefore, k follows the sequence 1; 2; 4; 8; : : : and always gives the
subscript of the next value xk to be saved in y.
   Lines 8–10 try to ﬁnd a factor of n, using the saved value of y and the cur-
rent value of xi . Speciﬁcally, line 8 computes the greatest common divisor
d D gcd.y  xi ; n/. If line 9 ﬁnds d to be a nontrivial divisor of n, then line 10
prints d .
   This procedure for ﬁnding a factor may seem somewhat mysterious at ﬁrst.
Note, however, that P OLLARD -R HO never prints an incorrect answer; any num-
ber it prints is a nontrivial divisor of n. P OLLARD -R HO might not print anything
at all, though; it comes with no guarantee that it will print any divisors. We shall
see, however, that we have good reason to expect P OLLARD -R HO to print a fac-
                     p
tor p of n after ‚. p/ iterations of the while loop. Thus, if n is composite, we
can expect this procedure to discover enough divisors to factor n completely after
approximately n1=4 updates, p       since every prime factor p of n except possibly the
largest one is less than n.
   We begin our analysis of how this procedure behaves by studying how long
it takes a random sequence modulo n to repeat a value. Since Zn is ﬁnite, and
since each value in the sequence (31.44) depends only on the previous value, the
sequence (31.44) eventually repeats itself. Once we reach an xi such that xi D xj
for some j < i, we are in a cycle, since xi C1 D xj C1 , xi C2 D xj C2 , and so on.
The reason for the name “rho heuristic” is that, as Figure 31.7 shows, we can draw
the sequence x1 ; x2 ; : : : ; xj 1 as the “tail” of the rho and the cycle xj ; xj C1 ; : : : ; xi
as the “body” of the rho.
   Let us consider the question of how long it takes for the sequence of xi to repeat.
This information is not exactly what we need, but we shall see later how to modify
the argument. For the purpose of this estimation, let us assume that the function
fn .x/ D .x 2  1/ mod n
behaves like a “random” function. Of course, it is not really random, but this as-
sumption yields results consistent with the observed behavior of P OLLARD -R HO.
We can then consider each xi to have been independently drawn from Zn according
to a uniform distribution
              p           on Zn . By the birthday-paradox analysis of Section 5.4.1,
we expect ‚. n/ steps to be taken before the sequence cycles.
   Now for the required modiﬁcation. Let p be a nontrivial factor of n such that
gcd.p; n=p/ D 1. For example, if n has the factorization n D p1e1 p2e2    prer , then
we may take p to be p1e1 . (If e1 D 1, then p is just the smallest prime factor of n,
a good example to keep in mind.)
