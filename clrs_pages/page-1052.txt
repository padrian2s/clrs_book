33.3 Finding the convex hull                                                     1031


and it eventually pops from the stack each point that is not a vertex of CH.Q/.
When the algorithm terminates, stack S contains exactly the vertices of CH.Q/, in
counterclockwise order of their appearance on the boundary.
   The procedure G RAHAM -S CAN takes as input a set Q of points, where jQj  3.
It calls the functions T OP.S/, which returns the point on top of stack S without
changing S, and N EXT-T O -T OP.S/, which returns the point one entry below the
top of stack S without changing S. As we shall prove in a moment, the stack S
returned by G RAHAM -S CAN contains, from bottom to top, exactly the vertices
of CH.Q/ in counterclockwise order.

G RAHAM -S CAN .Q/
 1 let p0 be the point in Q with the minimum y-coordinate,
        or the leftmost such point in case of a tie
 2 let hp1 ; p2 ; : : : ; pm i be the remaining points in Q,
        sorted by polar angle in counterclockwise order around p0
        (if more than one point has the same angle, remove all but
        the one that is farthest from p0 )
 3 let S be an empty stack
 4 P USH .p0 ; S/
 5 P USH .p1 ; S/
 6 P USH .p2 ; S/
 7 for i D 3 to m
 8      while the angle formed by points N EXT-T O -T OP.S/, T OP.S/,
                      and pi makes a nonleft turn
 9            P OP.S/
10      P USH .pi ; S/
11 return S

Figure 33.7 illustrates the progress of G RAHAM -S CAN. Line 1 chooses point p0
as the point with the lowest y-coordinate, picking the leftmost such point in case
of a tie. Since there is no point in Q that is below p0 and any other points with
the same y-coordinate are to its right, p0 must be a vertex of CH.Q/. Line 2
sorts the remaining points of Q by polar angle relative to p0 , using the same
method—comparing cross products—as in Exercise 33.1-3. If two or more points
have the same polar angle relative to p0 , all but the farthest such point are convex
combinations of p0 and the farthest point, and so we remove them entirely from
consideration. We let m denote the number of points other than p0 that remain.
The polar angle, measured in radians, of each point in Q relative to p0 is in the
half-open interval Œ0; /. Since the points are sorted according to polar angles,
they are sorted in counterclockwise order relative to p0 . We designate this sorted
sequence of points by hp1 ; p2 ; : : : ; pm i. Note that points p1 and pm are vertices
