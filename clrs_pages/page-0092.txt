            4.1 The maximum-subarray problem                                                                    71


             crosses the midpoint
                                                                                         AŒmid C 1 : : j 
low                    mid                         high           low        i     mid                        high


                             mid C 1                                                       mid C 1    j
entirely in AŒlow : : mid      entirely in AŒmid C 1 : : high             AŒi : : mid
                         (a)                                                          (b)

            Figure 4.4 (a) Possible locations of subarrays of AŒlow : : high: entirely in AŒlow : : mid, entirely
            in AŒmid C 1 : : high, or crossing the midpoint mid. (b) Any subarray of AŒlow : : high crossing
            the midpoint comprises two subarrays AŒi : : mid and AŒmid C 1 : : j , where low  i  mid and
            mid < j  high.

            maximum subarray that crosses the midpoint, and take a subarray with the largest
            sum of the three.
               We can easily ﬁnd a maximum subarray crossing the midpoint in time linear
            in the size of the subarray AŒlow : : high. This problem is not a smaller instance
            of our original problem, because it has the added restriction that the subarray it
            chooses must cross the midpoint. As Figure 4.4(b) shows, any subarray crossing
            the midpoint is itself made of two subarrays AŒi : : mid and AŒmid C 1 : : j , where
            low  i  mid and mid < j  high. Therefore, we just need to ﬁnd maximum
            subarrays of the form AŒi : : mid and AŒmid C 1 : : j  and then combine them. The
            procedure F IND -M AX -C ROSSING -S UBARRAY takes as input the array A and the
            indices low, mid, and high, and it returns a tuple containing the indices demarcating
            a maximum subarray that crosses the midpoint, along with the sum of the values in
            a maximum subarray.
            F IND -M AX -C ROSSING -S UBARRAY .A; low; mid; high/
             1 left-sum D 1
             2 sum D 0
             3 for i D mid downto low
             4       sum D sum C AŒi
             5       if sum > left-sum
             6            left-sum D sum
             7            max-left D i
             8 right-sum D 1
             9 sum D 0
            10 for j D mid C 1 to high
            11       sum D sum C AŒj 
            12       if sum > right-sum
            13            right-sum D sum
            14            max-right D j
            15 return .max-left; max-right; left-sum C right-sum/
